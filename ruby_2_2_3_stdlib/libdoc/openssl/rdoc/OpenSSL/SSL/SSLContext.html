<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <!-- classpage -- >
    <!-- RD version: 0.33.0  -->
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  <meta name='description' content='  Class : OpenSSL::SSL::SSLContext  -   Ruby 2_2_3 ' />
  <meta content="2015-10-03 10:47:33 -0500" http-equiv="change-date" />
  <!-- rel_prefix  = '../..'  ENV['RDOC_FOR_WEBSITE']   = true-->
    
  <!-- rel_prefix = '../..'   asset_rel_prefix = '../..'  --> 
  <title>Class: OpenSSL::SSL::SSLContext (Ruby 2_2_3) </title>
  <!-- link rel="stylesheet" href="../..css/obf.css"  -->
  <link rel="stylesheet" href="../../css/inuit.css" >
  <link rel="stylesheet" href="../../css/grid.inuit.css" >
  <link rel="stylesheet" href="../../css/2011.css" type="text/css" >
  <link rel="stylesheet" href="../../css/rdoc.css" type="text/css" >

  <script src="../../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/rubydoc.js" type="text/javascript" charset="utf-8"></script> 

 
<script src="../../js/highlight.min.js"></script>
<script> 
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
  </script> 

  <style type='text/css'>

    #vulns-alert #vulns{
      background-color: #c33 ! important;
      width: 100%;
      text-align: center;
   }
   
   #vulns-alert #vulns a {
    color: #F99 ! important;
   }
 </style>

</head>

<body id="top" class="class rdocstar">
<div id='actionbar' >
<div class='wrapper'>
  <ul class='grids g0'>
	<li class='grid-2' ><a href='/' target='_top' >Home</a></li>
	<li class='grid-2' ><a href='/core' target='_top' >Core </a></li>
	<li class='grid-2' ><a href='/stdlib' target='_top' >Std-lib </a></li>

	 <!-- li class='grid-2' ><a href='/zems' target='_top' >Zems</a></li -->
   <li class='grid-2' ><a href='/downloads' target='_top' >Downloads</a></li>
	 <li class='grid-5 right' id='rd-action-search'><form id="searchbox_011815814100681837392:wnccv6st5qk" action="http://ruby-doc.com/search.html"><input type="hidden" name="cx" value="011815814100681837392:wnccv6st5qk" ><input  id='rd-search-input' name="q" type="text" size="20" >&#160;&#160;<input type="submit" name="sa" value="Search" ><input type="hidden" name="cof" value="FORID:9" ></form></li>
	</ul>
</div>
<span id='vulns-alert'></span>
<!-- VERSION HEADER for 2_2_3 NOT FOUND --></div> <!-- end action bar -->
 <div class='wrapper'>
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
          
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul id='file-metadata'>

          
          
          
          <li class='in-file'>openssl/lib/openssl/ssl.rb</li>      
            
          
          <li class='in-file'>openssl/ossl_ssl.c</li>      
            
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-ciphers">#ciphers</a></li>
          
          <li><a href="#method-i-ciphers-3D">#ciphers=</a></li>
          
          <li><a href="#method-i-flush_sessions">#flush_sessions</a></li>
          
          <li><a href="#method-i-session_add">#session_add</a></li>
          
          <li><a href="#method-i-session_cache_mode">#session_cache_mode</a></li>
          
          <li><a href="#method-i-session_cache_mode-3D">#session_cache_mode=</a></li>
          
          <li><a href="#method-i-session_cache_size">#session_cache_size</a></li>
          
          <li><a href="#method-i-session_cache_size-3D">#session_cache_size=</a></li>
          
          <li><a href="#method-i-session_cache_stats">#session_cache_stats</a></li>
          
          <li><a href="#method-i-session_remove">#session_remove</a></li>
          
          <li><a href="#method-i-set_params">#set_params</a></li>
          
          <li><a href="#method-i-setup">#setup</a></li>
          
          <li><a href="#method-i-ssl_version-3D">#ssl_version=</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
          
          
          
          <li><a href="../../Integer.html">Integer</a></li>
        
          
          
          <li><a href="../../OpenSSL/ASN1.html">OpenSSL::ASN1</a></li>
        
          
          
          <li><a href="../../OpenSSL/ASN1/ASN1Data.html">OpenSSL::ASN1::ASN1Data</a></li>
        
          
          
          <li><a href="../../OpenSSL/ASN1/ASN1Error.html">OpenSSL::ASN1::ASN1Error</a></li>
        
          
          
          <li><a href="../../OpenSSL/ASN1/Constructive.html">OpenSSL::ASN1::Constructive</a></li>
        
          
          
          <li><a href="../../OpenSSL/ASN1/ObjectId.html">OpenSSL::ASN1::ObjectId</a></li>
        
          
          
          <li><a href="../../OpenSSL/ASN1/Primitive.html">OpenSSL::ASN1::Primitive</a></li>
        
          
          
          <li><a href="../../OpenSSL/BN.html">OpenSSL::BN</a></li>
        
          
          
          <li><a href="../../OpenSSL/BNError.html">OpenSSL::BNError</a></li>
        
          
          
          <li><a href="../../OpenSSL/Buffering.html">OpenSSL::Buffering</a></li>
        
          
          
          <li><a href="../../OpenSSL/Cipher.html">OpenSSL::Cipher</a></li>
        
          
          
          <li><a href="../../OpenSSL/Cipher/Cipher.html">OpenSSL::Cipher::Cipher</a></li>
        
          
          
          <li><a href="../../OpenSSL/Cipher/CipherError.html">OpenSSL::Cipher::CipherError</a></li>
        
          
          
          <li><a href="../../OpenSSL/Config.html">OpenSSL::Config</a></li>
        
          
          
          <li><a href="../../OpenSSL/ConfigError.html">OpenSSL::ConfigError</a></li>
        
          
          
          <li><a href="../../OpenSSL/Digest.html">OpenSSL::Digest</a></li>
        
          
          
          <li><a href="../../OpenSSL/Digest/DigestError.html">OpenSSL::Digest::DigestError</a></li>
        
          
          
          <li><a href="../../OpenSSL/Engine.html">OpenSSL::Engine</a></li>
        
          
          
          <li><a href="../../OpenSSL/Engine/EngineError.html">OpenSSL::Engine::EngineError</a></li>
        
          
          
          <li><a href="../../OpenSSL/HMAC.html">OpenSSL::HMAC</a></li>
        
          
          
          <li><a href="../../OpenSSL/HMACError.html">OpenSSL::HMACError</a></li>
        
          
          
          <li><a href="../../OpenSSL/Netscape.html">OpenSSL::Netscape</a></li>
        
          
          
          <li><a href="../../OpenSSL/Netscape/SPKI.html">OpenSSL::Netscape::SPKI</a></li>
        
          
          
          <li><a href="../../OpenSSL/Netscape/SPKIError.html">OpenSSL::Netscape::SPKIError</a></li>
        
          
          
          <li><a href="../../OpenSSL/OCSP.html">OpenSSL::OCSP</a></li>
        
          
          
          <li><a href="../../OpenSSL/OCSP/BasicResponse.html">OpenSSL::OCSP::BasicResponse</a></li>
        
          
          
          <li><a href="../../OpenSSL/OCSP/CertificateId.html">OpenSSL::OCSP::CertificateId</a></li>
        
          
          
          <li><a href="../../OpenSSL/OCSP/OCSPError.html">OpenSSL::OCSP::OCSPError</a></li>
        
          
          
          <li><a href="../../OpenSSL/OCSP/Request.html">OpenSSL::OCSP::Request</a></li>
        
          
          
          <li><a href="../../OpenSSL/OCSP/Response.html">OpenSSL::OCSP::Response</a></li>
        
          
          
          <li><a href="../../OpenSSL/OpenSSLError.html">OpenSSL::OpenSSLError</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKCS12.html">OpenSSL::PKCS12</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKCS12/PKCS12Error.html">OpenSSL::PKCS12::PKCS12Error</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKCS5.html">OpenSSL::PKCS5</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKCS5/PKCS5Error.html">OpenSSL::PKCS5::PKCS5Error</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKCS7.html">OpenSSL::PKCS7</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKCS7/PKCS7Error.html">OpenSSL::PKCS7::PKCS7Error</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKCS7/RecipientInfo.html">OpenSSL::PKCS7::RecipientInfo</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKCS7/SignerInfo.html">OpenSSL::PKCS7::SignerInfo</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey.html">OpenSSL::PKey</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/DH.html">OpenSSL::PKey::DH</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/DHError.html">OpenSSL::PKey::DHError</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/DSA.html">OpenSSL::PKey::DSA</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/DSAError.html">OpenSSL::PKey::DSAError</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/EC.html">OpenSSL::PKey::EC</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/EC/Group.html">OpenSSL::PKey::EC::Group</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/EC/Group/Error.html">OpenSSL::PKey::EC::Group::Error</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/EC/Point.html">OpenSSL::PKey::EC::Point</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/EC/Point/Error.html">OpenSSL::PKey::EC::Point::Error</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/ECError.html">OpenSSL::PKey::ECError</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/PKey.html">OpenSSL::PKey::PKey</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/PKeyError.html">OpenSSL::PKey::PKeyError</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/RSA.html">OpenSSL::PKey::RSA</a></li>
        
          
          
          <li><a href="../../OpenSSL/PKey/RSAError.html">OpenSSL::PKey::RSAError</a></li>
        
          
          
          <li><a href="../../OpenSSL/Random.html">OpenSSL::Random</a></li>
        
          
          
          <li><a href="../../OpenSSL/Random/RandomError.html">OpenSSL::Random::RandomError</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL.html">OpenSSL::SSL</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/Nonblock.html">OpenSSL::SSL::Nonblock</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/SSLContext.html">OpenSSL::SSL::SSLContext</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/SSLError.html">OpenSSL::SSL::SSLError</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/SSLErrorWaitReadable.html">OpenSSL::SSL::SSLErrorWaitReadable</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/SSLErrorWaitWritable.html">OpenSSL::SSL::SSLErrorWaitWritable</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/SSLServer.html">OpenSSL::SSL::SSLServer</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/SSLSocket.html">OpenSSL::SSL::SSLSocket</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/Session.html">OpenSSL::SSL::Session</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/Session/SessionError.html">OpenSSL::SSL::Session::SessionError</a></li>
        
          
          
          <li><a href="../../OpenSSL/SSL/SocketForwarder.html">OpenSSL::SSL::SocketForwarder</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509.html">OpenSSL::X509</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/Attribute.html">OpenSSL::X509::Attribute</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/AttributeError.html">OpenSSL::X509::AttributeError</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/CRL.html">OpenSSL::X509::CRL</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/CRLError.html">OpenSSL::X509::CRLError</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/Certificate.html">OpenSSL::X509::Certificate</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/CertificateError.html">OpenSSL::X509::CertificateError</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/Extension.html">OpenSSL::X509::Extension</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/ExtensionError.html">OpenSSL::X509::ExtensionError</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/ExtensionFactory.html">OpenSSL::X509::ExtensionFactory</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/Name.html">OpenSSL::X509::Name</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/Name/RFC2253DN.html">OpenSSL::X509::Name::RFC2253DN</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/NameError.html">OpenSSL::X509::NameError</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/Request.html">OpenSSL::X509::Request</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/RequestError.html">OpenSSL::X509::RequestError</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/Revoked.html">OpenSSL::X509::Revoked</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/RevokedError.html">OpenSSL::X509::RevokedError</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/Store.html">OpenSSL::X509::Store</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/StoreContext.html">OpenSSL::X509::StoreContext</a></li>
        
          
          
          <li><a href="../../OpenSSL/X509/StoreError.html">OpenSSL::X509::StoreError</a></li>
        
          
          
          <li><a href="../../unknown.html">unknown</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div> <!-- metadata -->
  <div class='adzbox'  id="azk83167">
    
   <div id="carbonads-container"><div class="carbonad"><div id="azcarbon"></div><script type="text/javascript">var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = "http://engine.carbonads.com/z/19647/azcarbon_2_1_0_VERT"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script></div></div>
<script type="text/javascript">
  function checkCarbs() {
    var searchFor = ".car" + "bona" + "d-tag";
    var ctext = $(searchFor);
    if (!ctext.length ) {
     // alert("Cannot find element with class " + searchFor );
      $("#azcarbon").append("<div class='rd-ab-msg'>If you are running an ad blocker please consider white-listing ruby-doc.org. <br><br>Thank you.</div>");
    }
  }
//  window.setTimeout(checkCarbs,3000); 
</script>

   
  </div> 
  <div id="documentation">
    <h1 class="class">OpenSSL::SSL::SSLContext</h1>

    <div id="description" class="description">
      
<p>An <a href="SSLContext.html">SSLContext</a> is used to set various options
regarding certificates, algorithms, verification, session caching, etc. 
The <a href="SSLContext.html">SSLContext</a> is used to create an <a
href="SSLSocket.html">SSLSocket</a>.</p>

<p>All attributes must be set before creating an <a
href="SSLSocket.html">SSLSocket</a> as the <a
href="SSLContext.html">SSLContext</a> will be frozen afterward.</p>

<p>The following attributes are available but don't show up in rdoc:</p>
<ul><li>
<p>ssl_version, cert, key, <a
href="SSLContext.html#attribute-i-client_ca">#client_ca</a>, <a
href="SSLContext.html#attribute-i-ca_file">#ca_file</a>, <a
href="SSLContext.html#attribute-i-ca_path">#ca_path</a>, timeout,</p>
</li><li>
<p><a href="SSLContext.html#attribute-i-verify_mode">#verify_mode</a>, <a
href="SSLContext.html#attribute-i-verify_depth">#verify_depth</a> <a
href="SSLContext.html#attribute-i-client_cert_cb">#client_cert_cb</a>, <a
href="SSLContext.html#attribute-i-tmp_dh_callback">#tmp_dh_callback</a>,</p>
</li><li>
<p><a
href="SSLContext.html#attribute-i-session_id_context">#session_id_context</a>,
session_add_cb, <a
href="SSLContext.html#attribute-i-session_new_cb">#session_new_cb</a>, <a
href="SSLContext.html#attribute-i-session_remove_cb">#session_remove_cb</a></p>
</li></ul>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="DEFAULT_CERT_STORE">DEFAULT_CERT_STORE</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="DEFAULT_PARAMS">DEFAULT_PARAMS</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="METHODS">METHODS</a></dt>
          
          <dd class="description"><p>The list of available SSL/TLS methods</p></dd>
          
        
          <dt><a name="SESSION_CACHE_BOTH">SESSION_CACHE_BOTH</a></dt>
          
          <dd class="description"><p>Both client and server sessions are added to the session cache</p></dd>
          
        
          <dt><a name="SESSION_CACHE_CLIENT">SESSION_CACHE_CLIENT</a></dt>
          
          <dd class="description"><p>Client sessions are added to the session cache</p></dd>
          
        
          <dt><a name="SESSION_CACHE_NO_AUTO_CLEAR">SESSION_CACHE_NO_AUTO_CLEAR</a></dt>
          
          <dd class="description"><p>Normally the session cache is checked for expired sessions every 255
connections.  Since this may lead to a delay that cannot be controlled, the
automatic flushing may be disabled and <a
href="SSLContext.html#method-i-flush_sessions">flush_sessions</a> can be
called explicitly.</p></dd>
          
        
          <dt><a name="SESSION_CACHE_NO_INTERNAL">SESSION_CACHE_NO_INTERNAL</a></dt>
          
          <dd class="description"><p>Enables both <a
href="SSLContext.html#SESSION_CACHE_NO_INTERNAL_LOOKUP">SESSION_CACHE_NO_INTERNAL_LOOKUP</a>
and <a
href="SSLContext.html#SESSION_CACHE_NO_INTERNAL_STORE">SESSION_CACHE_NO_INTERNAL_STORE</a>.</p></dd>
          
        
          <dt><a name="SESSION_CACHE_NO_INTERNAL_LOOKUP">SESSION_CACHE_NO_INTERNAL_LOOKUP</a></dt>
          
          <dd class="description"><p>Always perform external lookups of sessions even if they are in the
internal cache.</p>

<p>This flag has no effect on clients</p></dd>
          
        
          <dt><a name="SESSION_CACHE_NO_INTERNAL_STORE">SESSION_CACHE_NO_INTERNAL_STORE</a></dt>
          
          <dd class="description"><p>Never automatically store sessions in the internal store.</p></dd>
          
        
          <dt><a name="SESSION_CACHE_OFF">SESSION_CACHE_OFF</a></dt>
          
          <dd class="description"><p>No session caching for client or server</p></dd>
          
        
          <dt><a name="SESSION_CACHE_SERVER">SESSION_CACHE_SERVER</a></dt>
          
          <dd class="description"><p>Server sessions are added to the session cache</p></dd>
          
        
        </dl>
      </div>
      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="ca_file-attribute-method" class="method-detail">
          <a name="ca_file"></a>
          
          <a name="ca_file="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">ca_file</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>The path to a file containing a PEM-format CA certificate</p>
          
          </div>
        </div>
        
        <div id="ca_path-attribute-method" class="method-detail">
          <a name="ca_path"></a>
          
          <a name="ca_path="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">ca_path</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>The path to a directory containing CA certificates in PEM format.</p>

<p>Files are looked up by subject’s <a href="../X509.html">X509</a> name’s
hash value.</p>
          
          </div>
        </div>
        
        <div id="cert-attribute-method" class="method-detail">
          <a name="cert"></a>
          
          <a name="cert="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">cert</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>Context certificate</p>
          
          </div>
        </div>
        
        <div id="cert_store-attribute-method" class="method-detail">
          <a name="cert_store"></a>
          
          <a name="cert_store="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">cert_store</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>An <a href="../X509/Store.html">OpenSSL::X509::Store</a> used for
certificate verification</p>
          
          </div>
        </div>
        
        <div id="client_ca-attribute-method" class="method-detail">
          <a name="client_ca"></a>
          
          <a name="client_ca="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">client_ca</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A certificate or Array of certificates that will be sent to the client.</p>
          
          </div>
        </div>
        
        <div id="client_cert_cb-attribute-method" class="method-detail">
          <a name="client_cert_cb"></a>
          
          <a name="client_cert_cb="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">client_cert_cb</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback invoked when a client certificate is requested by a server and
no certificate has been set.</p>

<p>The callback is invoked with a <a href="Session.html">Session</a> and must
return an Array containing an <a
href="../X509/Certificate.html">OpenSSL::X509::Certificate</a> and an <a
href="../PKey.html">OpenSSL::PKey</a>.  If any other value is returned the
handshake is suspended.</p>
          
          </div>
        </div>
        
        <div id="extra_chain_cert-attribute-method" class="method-detail">
          <a name="extra_chain_cert"></a>
          
          <a name="extra_chain_cert="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">extra_chain_cert</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>An Array of extra <a href="../X509.html">X509</a> certificates to be added
to the certificate chain.</p>
          
          </div>
        </div>
        
        <div id="key-attribute-method" class="method-detail">
          <a name="key"></a>
          
          <a name="key="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">key</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>Context private key</p>
          
          </div>
        </div>
        
        <div id="npn_protocols-attribute-method" class="method-detail">
          <a name="npn_protocols"></a>
          
          <a name="npn_protocols="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">npn_protocols</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>An Enumerable of Strings. Each String represents a protocol to be
advertised as the list of supported protocols for Next Protocol
Negotiation. Supported in OpenSSL 1.0.1 and higher. Has no effect on the
client side. If not set explicitly, the NPN extension will not be sent by
the server in the handshake.</p>

<h3 id="attribute-i-npn_protocols-label-Example">Example<span><a href="#attribute-i-npn_protocols-label-Example">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-identifier">ctx</span>.<span class="ruby-identifier">npn_protocols</span> = [<span class="ruby-string">&quot;http/1.1&quot;</span>, <span class="ruby-string">&quot;spdy/2&quot;</span>]
</pre>
          
          </div>
        </div>
        
        <div id="npn_select_cb-attribute-method" class="method-detail">
          <a name="npn_select_cb"></a>
          
          <a name="npn_select_cb="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">npn_select_cb</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback invoked on the client side when the client needs to select a
protocol from the list sent by the server. Supported in OpenSSL 1.0.1 and
higher. The client MUST select a protocol of those advertised by the
server. If none is acceptable, raising an error in the callback will cause
the handshake to fail. Not setting this callback explicitly means not
supporting the NPN extension on the client - any protocols advertised by
the server will be ignored.</p>

<h3 id="attribute-i-npn_select_cb-label-Example">Example<span><a href="#attribute-i-npn_select_cb-label-Example">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-identifier">ctx</span>.<span class="ruby-identifier">npn_select_cb</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">protocols</span><span class="ruby-operator">|</span>
  <span class="ruby-comment">#inspect the protocols and select one</span>
  <span class="ruby-identifier">protocols</span>.<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span>
</pre>
          
          </div>
        </div>
        
        <div id="options-attribute-method" class="method-detail">
          <a name="options"></a>
          
          <a name="options="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">options</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>Sets various OpenSSL options.</p>
          
          </div>
        </div>
        
        <div id="renegotiation_cb-attribute-method" class="method-detail">
          <a name="renegotiation_cb"></a>
          
          <a name="renegotiation_cb="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">renegotiation_cb</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback invoked whenever a new handshake is initiated. May be used to
disable renegotiation entirely.</p>

<p>The callback is invoked with the active <a
href="SSLSocket.html">SSLSocket</a>. The callback’s return value is
irrelevant, normal return indicates “approval” of the renegotiation and
will continue the process. To forbid renegotiation and to cancel the
process, an Error may be raised within the callback.</p>

<h3 id="attribute-i-renegotiation_cb-label-Disable+client+renegotiation">Disable client renegotiation<span><a href="#attribute-i-renegotiation_cb-label-Disable+client+renegotiation">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>When running a server, it is often desirable to disable client
renegotiation entirely. You may use a callback as follows to implement this
feature:</p>

<pre class="ruby"><span class="ruby-identifier">num_handshakes</span> = <span class="ruby-value">0</span>
<span class="ruby-identifier">ctx</span>.<span class="ruby-identifier">renegotiation_cb</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ssl</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">num_handshakes</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">RuntimeError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;Client renegotiation disabled&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">num_handshakes</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span>
</pre>
          
          </div>
        </div>
        
        <div id="servername_cb-attribute-method" class="method-detail">
          <a name="servername_cb"></a>
          
          <a name="servername_cb="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">servername_cb</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback invoked at connect time to distinguish between multiple server
names.</p>

<p>The callback is invoked with an <a href="SSLSocket.html">SSLSocket</a> and
a server name.  The callback must return an <a
href="SSLContext.html">SSLContext</a> for the server name or nil.</p>
          
          </div>
        </div>
        
        <div id="session_get_cb-attribute-method" class="method-detail">
          <a name="session_get_cb"></a>
          
          <a name="session_get_cb="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">session_get_cb</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback invoked on a server when a session is proposed by the client but
the session could not be found in the server’s internal cache.</p>

<p>The callback is invoked with the <a href="SSLSocket.html">SSLSocket</a> and
session id.  The callback may return a <a href="Session.html">Session</a>
from an external cache.</p>
          
          </div>
        </div>
        
        <div id="session_id_context-attribute-method" class="method-detail">
          <a name="session_id_context"></a>
          
          <a name="session_id_context="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">session_id_context</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>Sets the context in which a session can be reused.  This allows sessions
for multiple applications to be distinguished, for example, by name.</p>
          
          </div>
        </div>
        
        <div id="session_new_cb-attribute-method" class="method-detail">
          <a name="session_new_cb"></a>
          
          <a name="session_new_cb="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">session_new_cb</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback invoked when a new session was negotiated.</p>

<p>The callback is invoked with an <a href="SSLSocket.html">SSLSocket</a>.  If
false is returned the session will be removed from the internal cache.</p>
          
          </div>
        </div>
        
        <div id="session_remove_cb-attribute-method" class="method-detail">
          <a name="session_remove_cb"></a>
          
          <a name="session_remove_cb="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">session_remove_cb</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback invoked when a session is removed from the internal cache.</p>

<p>The callback is invoked with an <a href="SSLContext.html">SSLContext</a>
and a <a href="Session.html">Session</a>.</p>
          
          </div>
        </div>
        
        <div id="ssl_timeout-attribute-method" class="method-detail">
          <a name="ssl_timeout"></a>
          
          <a name="ssl_timeout="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">ssl_timeout</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>Maximum session lifetime.</p>
          
          </div>
        </div>
        
        <div id="timeout-attribute-method" class="method-detail">
          <a name="timeout"></a>
          
          <a name="timeout="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">timeout</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>Maximum session lifetime.</p>
          
          </div>
        </div>
        
        <div id="tmp_dh_callback-attribute-method" class="method-detail">
          <a name="tmp_dh_callback"></a>
          
          <a name="tmp_dh_callback="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">tmp_dh_callback</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback invoked when DH parameters are required.</p>

<p>The callback is invoked with the <a href="Session.html">Session</a> for the
key exchange, an flag indicating the use of an export cipher and the
keylength required.</p>

<p>The callback must return an <a href="../PKey/DH.html">OpenSSL::PKey::DH</a>
instance of the correct key length.</p>
          
          </div>
        </div>
        
        <div id="verify_callback-attribute-method" class="method-detail">
          <a name="verify_callback"></a>
          
          <a name="verify_callback="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">verify_callback</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>A callback for additional certificate verification.  The callback is
invoked for each certificate in the chain.</p>

<p>The callback is invoked with two values.  <code>preverify_ok</code>
indicates indicates if the verification was passed (true) or not (false).
<code>store_context</code> is an <a
href="../X509/StoreContext.html">OpenSSL::X509::StoreContext</a> containing
the context used for certificate verification.</p>

<p>If the callback returns false verification is stopped.</p>
          
          </div>
        </div>
        
        <div id="verify_depth-attribute-method" class="method-detail">
          <a name="verify_depth"></a>
          
          <a name="verify_depth="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">verify_depth</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p>Number of CA certificates to walk when verifying a certificate chain.</p>
          
          </div>
        </div>
        
        <div id="verify_mode-attribute-method" class="method-detail">
          <a name="verify_mode"></a>
          
          <a name="verify_mode="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">verify_mode</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description 245">
          
          <p><a href="Session.html">Session</a> verification mode.</p>

<p>Valid modes are VERIFY_NONE, VERIFY_PEER, VERIFY_CLIENT_ONCE,
VERIFY_FAIL_IF_NO_PEER_CERT and defined on <a
href="../SSL.html">OpenSSL::SSL</a></p>
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">new => ctx</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">new(:TLSv1) => ctx</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">new("SSLv23_client") => ctx</span>
            
          </div>
          
          
          <div>
  
            
            <p>You can get a list of valid methods with OpenSSL::SSL::SSLContext::METHODS</p>
            

            
            <div class="method-source-code" id="new-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_initialize(int argc, VALUE *argv, VALUE self)
{
    VALUE ssl_method;
    int i;

    for(i = 0; i &lt; numberof(ossl_sslctx_attrs); i++){
        char buf[32];
        snprintf(buf, sizeof(buf), &quot;@%s&quot;, ossl_sslctx_attrs[i]);
        rb_iv_set(self, buf, Qnil);
    }
    if (rb_scan_args(argc, argv, &quot;01&quot;, &amp;ssl_method) == 0){
        return self;
    }
    ossl_sslctx_set_ssl_version(self, ssl_method);

    return self;
}
            </pre> 
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->
      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="ciphers-method" class="method-detail ">
          <a name="method-i-ciphers"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">ciphers => [[name, version, bits, alg_bits], ...]</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>The list of ciphers configured for this context.</p>
            

            
            <div class="method-source-code" id="ciphers-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_get_ciphers(VALUE self)
{
    SSL_CTX *ctx;
    STACK_OF(SSL_CIPHER) *ciphers;
    SSL_CIPHER *cipher;
    VALUE ary;
    int i, num;

    GetSSLCTX(self, ctx);
    if(!ctx){
        rb_warning(&quot;SSL_CTX is not initialized.&quot;);
        return Qnil;
    }
    ciphers = ctx-&gt;cipher_list;

    if (!ciphers)
        return rb_ary_new();

    num = sk_SSL_CIPHER_num(ciphers);
    ary = rb_ary_new2(num);
    for(i = 0; i &lt; num; i++){
        cipher = sk_SSL_CIPHER_value(ciphers, i);
        rb_ary_push(ary, ossl_ssl_cipher_to_ary(cipher));
    }
    return ary;
}
            </pre> 
            </div><!-- ciphers-source -->
            
          </div>

          

          
        </div><!-- ciphers-method -->
      
        <div id="ciphers-3D-method" class="method-detail ">
          <a name="method-i-ciphers-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">ciphers = "cipher1:cipher2:..."</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">ciphers = [name, ...]</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">ciphers = [[name, version, bits, alg_bits], ...]</span>
            
          </div>
          
          
          <div>
  
            
            <p>Sets the list of available ciphers for this context.  Note in a server
context some ciphers require the appropriate certificates.  For example, an
RSA cipher can only be chosen when an RSA certificate is available.</p>

<p>See also <a href="../Cipher.html">OpenSSL::Cipher</a> and <a
href="../Cipher.html#method-c-ciphers">OpenSSL::Cipher.ciphers</a></p>
            

            
            <div class="method-source-code" id="ciphers-3D-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_set_ciphers(VALUE self, VALUE v)
{
    SSL_CTX *ctx;
    VALUE str, elem;
    int i;

    rb_check_frozen(self);
    if (NIL_P(v))
        return v;
    else if (RB_TYPE_P(v, T_ARRAY)) {
        str = rb_str_new(0, 0);
        for (i = 0; i &lt; RARRAY_LEN(v); i++) {
            elem = rb_ary_entry(v, i);
            if (RB_TYPE_P(elem, T_ARRAY)) elem = rb_ary_entry(elem, 0);
            elem = rb_String(elem);
            rb_str_append(str, elem);
            if (i &lt; RARRAY_LEN(v)-1) rb_str_cat2(str, &quot;:&quot;);
        }
    } else {
        str = v;
        StringValue(str);
    }

    GetSSLCTX(self, ctx);
    if(!ctx){
        ossl_raise(eSSLError, &quot;SSL_CTX is not initialized.&quot;);
        return Qnil;
    }
    if (!SSL_CTX_set_cipher_list(ctx, RSTRING_PTR(str))) {
        ossl_raise(eSSLError, &quot;SSL_CTX_set_cipher_list&quot;);
    }

    return v;
}
            </pre> 
            </div><!-- ciphers-3D-source -->
            
          </div>

          

          
        </div><!-- ciphers-3D-method -->
      
        <div id="flush_sessions-method" class="method-detail ">
          <a name="method-i-flush_sessions"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">flush_sessions(time | nil) &rarr; self</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Removes sessions in the internal cache that have expired at
<code>time</code>.</p>
            

            
            <div class="method-source-code" id="flush_sessions-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_flush_sessions(int argc, VALUE *argv, VALUE self)
{
    VALUE arg1;
    SSL_CTX *ctx;
    time_t tm = 0;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;arg1);

    GetSSLCTX(self, ctx);

    if (NIL_P(arg1)) {
        tm = time(0);
    } else if (rb_obj_is_instance_of(arg1, rb_cTime)) {
        tm = NUM2LONG(rb_funcall(arg1, rb_intern(&quot;to_i&quot;), 0));
    } else {
        ossl_raise(rb_eArgError, &quot;arg must be Time or nil&quot;);
    }

    SSL_CTX_flush_sessions(ctx, (long)tm);

    return self;
}
            </pre> 
            </div><!-- flush_sessions-source -->
            
          </div>

          

          
        </div><!-- flush_sessions-method -->
      
        <div id="session_add-method" class="method-detail ">
          <a name="method-i-session_add"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">session_add(session) &rarr; true | false</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Adds <code>session</code> to the session cache</p>
            

            
            <div class="method-source-code" id="session_add-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_session_add(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;
    SSL_SESSION *sess;

    GetSSLCTX(self, ctx);
    SafeGetSSLSession(arg, sess);

    return SSL_CTX_add_session(ctx, sess) == 1 ? Qtrue : Qfalse;
}
            </pre> 
            </div><!-- session_add-source -->
            
          </div>

          

          
        </div><!-- session_add-method -->
      
        <div id="session_cache_mode-method" class="method-detail ">
          <a name="method-i-session_cache_mode"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">session_cache_mode &rarr; Integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>The current session cache mode.</p>
            

            
            <div class="method-source-code" id="session_cache_mode-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_get_session_cache_mode(VALUE self)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

    return LONG2NUM(SSL_CTX_get_session_cache_mode(ctx));
}
            </pre> 
            </div><!-- session_cache_mode-source -->
            
          </div>

          

          
        </div><!-- session_cache_mode-method -->
      
        <div id="session_cache_mode-3D-method" class="method-detail ">
          <a name="method-i-session_cache_mode-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">session_cache_mode=(integer) &rarr; Integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Sets the <a href="../SSL.html">SSL</a> session cache mode.  Bitwise-or
together the desired SESSION_CACHE_* constants to set.  See
SSL_CTX_set_session_cache_mode(3) for details.</p>
            

            
            <div class="method-source-code" id="session_cache_mode-3D-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_set_session_cache_mode(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

    SSL_CTX_set_session_cache_mode(ctx, NUM2LONG(arg));

    return arg;
}
            </pre> 
            </div><!-- session_cache_mode-3D-source -->
            
          </div>

          

          
        </div><!-- session_cache_mode-3D-method -->
      
        <div id="session_cache_size-method" class="method-detail ">
          <a name="method-i-session_cache_size"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">session_cache_size &rarr; Integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the current session cache size.  Zero is used to represent an
unlimited cache size.</p>
            

            
            <div class="method-source-code" id="session_cache_size-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_get_session_cache_size(VALUE self)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

    return LONG2NUM(SSL_CTX_sess_get_cache_size(ctx));
}
            </pre> 
            </div><!-- session_cache_size-source -->
            
          </div>

          

          
        </div><!-- session_cache_size-method -->
      
        <div id="session_cache_size-3D-method" class="method-detail ">
          <a name="method-i-session_cache_size-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">session_cache_size=(integer) &rarr; Integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Sets the session cache size.  Returns the previously valid session cache
size.  Zero is used to represent an unlimited session cache size.</p>
            

            
            <div class="method-source-code" id="session_cache_size-3D-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_set_session_cache_size(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;

    GetSSLCTX(self, ctx);

    SSL_CTX_sess_set_cache_size(ctx, NUM2LONG(arg));

    return arg;
}
            </pre> 
            </div><!-- session_cache_size-3D-source -->
            
          </div>

          

          
        </div><!-- session_cache_size-3D-method -->
      
        <div id="session_cache_stats-method" class="method-detail ">
          <a name="method-i-session_cache_stats"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">session_cache_stats &rarr; Hash</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns a Hash containing the following keys:</p>
<dl class="rdoc-list note-list"><dt>:accept
<dd>
<p>Number of started SSL/TLS handshakes in server mode</p>
</dd><dt>:accept_good
<dd>
<p>Number of established SSL/TLS sessions in server mode</p>
</dd><dt>:accept_renegotiate
<dd>
<p>Number of start renegotiations in server mode</p>
</dd><dt>:cache_full
<dd>
<p>Number of sessions that were removed due to cache overflow</p>
</dd><dt>:cache_hits
<dd>
<p>Number of successfully reused connections</p>
</dd><dt>:cache_misses
<dd>
<p>Number of sessions proposed by clients that were not found in the cache</p>
</dd><dt>:cache_num
<dd>
<p>Number of sessions in the internal session cache</p>
</dd><dt>:cb_hits
<dd>
<p>Number of sessions retrieved from the external cache in server mode</p>
</dd><dt>:connect
<dd>
<p>Number of started SSL/TLS handshakes in client mode</p>
</dd><dt>:connect_good
<dd>
<p>Number of established SSL/TLS sessions in client mode</p>
</dd><dt>:connect_renegotiate
<dd>
<p>Number of start renegotiations in client mode</p>
</dd><dt>:timeouts
<dd>
<p>Number of sessions proposed by clients that were found in the cache but had
expired due to timeouts</p>
</dd></dl>
            

            
            <div class="method-source-code" id="session_cache_stats-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_get_session_cache_stats(VALUE self)
{
    SSL_CTX *ctx;
    VALUE hash;

    GetSSLCTX(self, ctx);

    hash = rb_hash_new();
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cache_num&quot;)), LONG2NUM(SSL_CTX_sess_number(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;connect&quot;)), LONG2NUM(SSL_CTX_sess_connect(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;connect_good&quot;)), LONG2NUM(SSL_CTX_sess_connect_good(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;connect_renegotiate&quot;)), LONG2NUM(SSL_CTX_sess_connect_renegotiate(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;accept&quot;)), LONG2NUM(SSL_CTX_sess_accept(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;accept_good&quot;)), LONG2NUM(SSL_CTX_sess_accept_good(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;accept_renegotiate&quot;)), LONG2NUM(SSL_CTX_sess_accept_renegotiate(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cache_hits&quot;)), LONG2NUM(SSL_CTX_sess_hits(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cb_hits&quot;)), LONG2NUM(SSL_CTX_sess_cb_hits(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cache_misses&quot;)), LONG2NUM(SSL_CTX_sess_misses(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cache_full&quot;)), LONG2NUM(SSL_CTX_sess_cache_full(ctx)));
    rb_hash_aset(hash, ID2SYM(rb_intern(&quot;timeouts&quot;)), LONG2NUM(SSL_CTX_sess_timeouts(ctx)));

    return hash;
}
            </pre> 
            </div><!-- session_cache_stats-source -->
            
          </div>

          

          
        </div><!-- session_cache_stats-method -->
      
        <div id="session_remove-method" class="method-detail ">
          <a name="method-i-session_remove"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">session_remove(session) &rarr; true | false</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Removes <code>session</code> from the session cache</p>
            

            
            <div class="method-source-code" id="session_remove-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_session_remove(VALUE self, VALUE arg)
{
    SSL_CTX *ctx;
    SSL_SESSION *sess;

    GetSSLCTX(self, ctx);
    SafeGetSSLSession(arg, sess);

    return SSL_CTX_remove_session(ctx, sess) == 1 ? Qtrue : Qfalse;
}
            </pre> 
            </div><!-- session_remove-source -->
            
          </div>

          

          
        </div><!-- session_remove-method -->
      
        <div id="set_params-method" class="method-detail ">
          <a name="method-i-set_params"></a>

          
          <div class="method-heading">
            <span class="method-name">set_params</span><span
              class="method-args">(params={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Sets the parameters for this <a href="../SSL.html">SSL</a> context to the
values in <code>params</code>. The keys in <code>params</code> must be
assignment methods on <a href="SSLContext.html">SSLContext</a>.</p>

<p>If the <a href="SSLContext.html#attribute-i-verify_mode">#verify_mode</a>
is not VERIFY_NONE and <a
href="SSLContext.html#attribute-i-ca_file">#ca_file</a>, <a
href="SSLContext.html#attribute-i-ca_path">#ca_path</a> and <a
href="SSLContext.html#attribute-i-cert_store">#cert_store</a> are not set
then the system default certificate store is used.</p>
            

            
            <div class="method-source-code" id="set_params-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File openssl/lib/openssl/ssl.rb, line 85</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_params</span>(<span class="ruby-identifier">params</span>={})
  <span class="ruby-identifier">params</span> = <span class="ruby-constant">DEFAULT_PARAMS</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">params</span>)
  <span class="ruby-identifier">params</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">__send__</span>(<span class="ruby-node">&quot;#{name}=&quot;</span>, <span class="ruby-identifier">value</span>) }
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">verify_mode</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_NONE</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">ca_file</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">ca_path</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cert_store</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cert_store</span> = <span class="ruby-constant">DEFAULT_CERT_STORE</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">params</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- set_params-source -->
            
          </div>

          

          
        </div><!-- set_params-method -->
      
        <div id="setup-method" class="method-detail ">
          <a name="method-i-setup"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">setup => Qtrue # first time</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">setup => nil # thereafter</span>
            
          </div>
          
          
          <div>
  
            
            <p>This method is called automatically when a new <a
href="SSLSocket.html">SSLSocket</a> is created. Normally you do not need to
call this method (unless you are writing an extension in C).</p>
            

            
            <div class="method-source-code" id="setup-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_setup(VALUE self)
{
    SSL_CTX *ctx;
    X509 *cert = NULL, *client_ca = NULL;
    X509_STORE *store;
    EVP_PKEY *key = NULL;
    char *ca_path = NULL, *ca_file = NULL;
    int i, verify_mode;
    VALUE val;

    if(OBJ_FROZEN(self)) return Qnil;
    GetSSLCTX(self, ctx);

#if !defined(OPENSSL_NO_DH)
    if (RTEST(ossl_sslctx_get_tmp_dh_cb(self))){
        SSL_CTX_set_tmp_dh_callback(ctx, ossl_tmp_dh_callback);
    }
    else{
        SSL_CTX_set_tmp_dh_callback(ctx, ossl_default_tmp_dh_callback);
    }
#endif
    SSL_CTX_set_ex_data(ctx, ossl_ssl_ex_ptr_idx, (void*)self);

    val = ossl_sslctx_get_cert_store(self);
    if(!NIL_P(val)){
        /*
         * WORKAROUND:
         *   X509_STORE can count references, but
         *   X509_STORE_free() doesn't care it.
         *   So we won't increment it but mark it by ex_data.
         */
        store = GetX509StorePtr(val); /* NO NEED TO DUP */
        SSL_CTX_set_cert_store(ctx, store);
        SSL_CTX_set_ex_data(ctx, ossl_ssl_ex_store_p, (void*)1);
    }

    val = ossl_sslctx_get_extra_cert(self);
    if(!NIL_P(val)){
        rb_block_call(val, rb_intern(&quot;each&quot;), 0, 0, ossl_sslctx_add_extra_chain_cert_i, self);
    }

    /* private key may be bundled in certificate file. */
    val = ossl_sslctx_get_cert(self);
    cert = NIL_P(val) ? NULL : GetX509CertPtr(val); /* NO DUP NEEDED */
    val = ossl_sslctx_get_key(self);
    key = NIL_P(val) ? NULL : GetPKeyPtr(val); /* NO DUP NEEDED */
    if (cert &amp;&amp; key) {
        if (!SSL_CTX_use_certificate(ctx, cert)) {
            /* Adds a ref =&gt; Safe to FREE */
            ossl_raise(eSSLError, &quot;SSL_CTX_use_certificate&quot;);
        }
        if (!SSL_CTX_use_PrivateKey(ctx, key)) {
            /* Adds a ref =&gt; Safe to FREE */
            ossl_raise(eSSLError, &quot;SSL_CTX_use_PrivateKey&quot;);
        }
        if (!SSL_CTX_check_private_key(ctx)) {
            ossl_raise(eSSLError, &quot;SSL_CTX_check_private_key&quot;);
        }
    }

    val = ossl_sslctx_get_client_ca(self);
    if(!NIL_P(val)){
        if (RB_TYPE_P(val, T_ARRAY)) {
            for(i = 0; i &lt; RARRAY_LEN(val); i++){
                client_ca = GetX509CertPtr(RARRAY_PTR(val)[i]);
                if (!SSL_CTX_add_client_CA(ctx, client_ca)){
                    /* Copies X509_NAME =&gt; FREE it. */
                    ossl_raise(eSSLError, &quot;SSL_CTX_add_client_CA&quot;);
                }
            }
        }
        else{
            client_ca = GetX509CertPtr(val); /* NO DUP NEEDED. */
            if (!SSL_CTX_add_client_CA(ctx, client_ca)){
                /* Copies X509_NAME =&gt; FREE it. */
                ossl_raise(eSSLError, &quot;SSL_CTX_add_client_CA&quot;);
            }
        }
    }

    val = ossl_sslctx_get_ca_file(self);
    ca_file = NIL_P(val) ? NULL : StringValuePtr(val);
    val = ossl_sslctx_get_ca_path(self);
    ca_path = NIL_P(val) ? NULL : StringValuePtr(val);
    if(ca_file || ca_path){
        if (!SSL_CTX_load_verify_locations(ctx, ca_file, ca_path))
            rb_warning(&quot;can't set verify locations&quot;);
    }

    val = ossl_sslctx_get_verify_mode(self);
    verify_mode = NIL_P(val) ? SSL_VERIFY_NONE : NUM2INT(val);
    SSL_CTX_set_verify(ctx, verify_mode, ossl_ssl_verify_callback);
    if (RTEST(ossl_sslctx_get_client_cert_cb(self)))
        SSL_CTX_set_client_cert_cb(ctx, ossl_client_cert_cb);

    val = ossl_sslctx_get_timeout(self);
    if(!NIL_P(val)) SSL_CTX_set_timeout(ctx, NUM2LONG(val));

    val = ossl_sslctx_get_verify_dep(self);
    if(!NIL_P(val)) SSL_CTX_set_verify_depth(ctx, NUM2INT(val));

    val = ossl_sslctx_get_options(self);
    if(!NIL_P(val)) {
        SSL_CTX_set_options(ctx, NUM2LONG(val));
    } else {
        SSL_CTX_set_options(ctx, SSL_OP_ALL);
    }

#ifdef HAVE_OPENSSL_NPN_NEGOTIATED
    val = rb_iv_get(self, &quot;@npn_protocols&quot;);
    if (!NIL_P(val)) {
        ssl_npn_encode_protocols(self, val);
        SSL_CTX_set_next_protos_advertised_cb(ctx, ssl_npn_advertise_cb, (void *) self);
        OSSL_Debug(&quot;SSL NPN advertise callback added&quot;);
    }
    if (RTEST(rb_iv_get(self, &quot;@npn_select_cb&quot;))) {
        SSL_CTX_set_next_proto_select_cb(ctx, ssl_npn_select_cb, (void *) self);
        OSSL_Debug(&quot;SSL NPN select callback added&quot;);
    }
#endif

    rb_obj_freeze(self);

    val = ossl_sslctx_get_sess_id_ctx(self);
    if (!NIL_P(val)){
        StringValue(val);
        if (!SSL_CTX_set_session_id_context(ctx, (unsigned char *)RSTRING_PTR(val),
                                            RSTRING_LENINT(val))){
            ossl_raise(eSSLError, &quot;SSL_CTX_set_session_id_context&quot;);
        }
    }

    if (RTEST(rb_iv_get(self, &quot;@session_get_cb&quot;))) {
        SSL_CTX_sess_set_get_cb(ctx, ossl_sslctx_session_get_cb);
        OSSL_Debug(&quot;SSL SESSION get callback added&quot;);
    }
    if (RTEST(rb_iv_get(self, &quot;@session_new_cb&quot;))) {
        SSL_CTX_sess_set_new_cb(ctx, ossl_sslctx_session_new_cb);
        OSSL_Debug(&quot;SSL SESSION new callback added&quot;);
    }
    if (RTEST(rb_iv_get(self, &quot;@session_remove_cb&quot;))) {
        SSL_CTX_sess_set_remove_cb(ctx, ossl_sslctx_session_remove_cb);
        OSSL_Debug(&quot;SSL SESSION remove callback added&quot;);
    }

#ifdef HAVE_SSL_SET_TLSEXT_HOST_NAME
    val = rb_iv_get(self, &quot;@servername_cb&quot;);
    if (!NIL_P(val)) {
        SSL_CTX_set_tlsext_servername_callback(ctx, ssl_servername_cb);
        OSSL_Debug(&quot;SSL TLSEXT servername callback added&quot;);
    }
#endif

    return Qtrue;
}
            </pre> 
            </div><!-- setup-source -->
            
          </div>

          

          
        </div><!-- setup-method -->
      
        <div id="ssl_version-3D-method" class="method-detail ">
          <a name="method-i-ssl_version-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">ssl_version = :TLSv1</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">ssl_version = "SSLv23_client"</span>
            
          </div>
          
          
          <div>
  
            
            <p>You can get a list of valid versions with OpenSSL::SSL::SSLContext::METHODS</p>
            

            
            <div class="method-source-code" id="ssl_version-3D-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
ossl_sslctx_set_ssl_version(VALUE self, VALUE ssl_method)
{
    SSL_METHOD *method = NULL;
    const char *s;
    int i;

    SSL_CTX *ctx;
    if (RB_TYPE_P(ssl_method, T_SYMBOL))
        s = rb_id2name(SYM2ID(ssl_method));
    else
        s =  StringValuePtr(ssl_method);
    for (i = 0; i &lt; numberof(ossl_ssl_method_tab); i++) {
        if (strcmp(ossl_ssl_method_tab[i].name, s) == 0) {
            method = ossl_ssl_method_tab[i].func();
            break;
        }
    }
    if (!method) {
        ossl_raise(rb_eArgError, &quot;unknown SSL method `%s'.&quot;, s);
    }
    GetSSLCTX(self, ctx);
    if (SSL_CTX_set_ssl_version(ctx, method) != 1) {
        ossl_raise(eSSLError, &quot;SSL_CTX_set_ssl_version&quot;);
    }

    return ssl_method;
}
            </pre> 
            </div><!-- ssl_version-3D-source -->
            
          </div>

          

          
        </div><!-- ssl_version-3D-method -->
      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  
  <div id='tx_SSLContext_versioned' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_SSLContext_versioned").load("/associated/2_2_3/SSLContext.html");</script> <div id='tx_SSLContext' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_SSLContext").load("/associated/SSLContext.html");</script> 
      
  <!-- disqus ? -->
   <div class='info'>
  <p>Commenting is here to help enhance the documentation.  For example, code samples, or clarification of the documentation.</p>
  <p>If you have questions about Ruby or the documentation, please post to one of the <a href='http://www.ruby-lang.org/en/community/mailing-lists/'>Ruby mailing lists</a>.  You will get better, faster, help that way.</p>
  <p>If you wish to post a correction of the docs, please do so, but also <a href='http://bugs.ruby-lang.org' >file bug report</a> so that it can be corrected for the next release. Thank you.</p>
  <p>If you want to help improve the Ruby documentation, please visit <a href='http://documenting-ruby.org/'>Documenting-ruby.org</a>.</p> 
    </div>


  
  </div><!-- documentation -->
  <div id='dynamic'>
  </div>
      
        <div id="disqus_thread"></div>
  <script type="text/javascript">
     function setDisqusUrl(){
      var _loc = window.location.href;
      disqus_url = _loc.split("?")[0];
    }

     var disqus_url;
     
    
     setDisqusUrl();
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    // var disqus_shortname = 'rubydocbeta'; // required 
    var disqus_shortname = 'ruby-doc'; // required 


    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

      
<div class='grids wrapper' id="footer">
  <p><small>This page was generated for Ruby 2_2_3</small></p> 
  
   <p><a href="http://ruby-doc.org">Ruby-doc.org</a> is provided by <a href="http://jamesbritt.com">James Britt</a> and <a href="http://neurogami.com">Neurogami</a>. <a href="http://neurogami.com">Hack your world.  Feed your head.  Live curious</a>.</p>
 
    <p><small>Generated with Ruby-doc Rdoc Generator 0.33.0</small>.</p>
  </div>
</div>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-335317-2', 'auto');
  ga('send', 'pageview');

</script>


    
 <script type='text/javascript'>
$(document).ready(function() {
      $.ajaxSetup({ cache: false });
      $("#vulns-alert").load("/associated/vulns.html");
    });

    </script>


 
		<script type='text/javascript'>

	function loadPlus(plusdocs){
//		var img_h = $("img.carbonad-image").css('height');
		//if(img_h != undefined) { //---
			$(plusdocs).find("div[class='associated_wrapper']").each (function() {
					$("#" + this.id).append($(plusdocs).find("#" + this.id ));
					});
		//} // ---
	} // end loadPlusdocs

   function loadInline(json){
    for (var lookFor in json) {
      $(lookFor).after(json[lookFor]);
     }
  } // end loadPlusdocs


$(document).ready(function() {
		$.ajaxSetup({ cache: false });
			$.get('/associated/2_2_3/plus_SSLContext.html', 
			function(plusdocs) {
			setTimeout(function() {
				loadPlus(plusdocs);
				}, 2000);
			}
			);


    $.ajax({
    dataType: "json",
     url: '/associated/2_2_3/inline_SSLContext.js',
     success: function(json) {
			setTimeout(function() {
				loadInline(json);
				}, 2000);
			}
   });

		});
</script>
		
</body>
</html>



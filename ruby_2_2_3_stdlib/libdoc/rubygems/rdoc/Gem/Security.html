<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <!-- classpage -- >
    <!-- RD version: 0.33.0  -->
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  <meta name='description' content='  Module : Gem::Security  -   Ruby 2_2_3 ' />
  <meta content="2015-10-03 10:48:29 -0500" http-equiv="change-date" />
  <!-- rel_prefix  = '..'  ENV['RDOC_FOR_WEBSITE']   = true-->
    
  <!-- rel_prefix = '..'   asset_rel_prefix = '..'  --> 
  <title>Module: Gem::Security (Ruby 2_2_3) </title>
  <!-- link rel="stylesheet" href="..css/obf.css"  -->
  <link rel="stylesheet" href="../css/inuit.css" >
  <link rel="stylesheet" href="../css/grid.inuit.css" >
  <link rel="stylesheet" href="../css/2011.css" type="text/css" >
  <link rel="stylesheet" href="../css/rdoc.css" type="text/css" >

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/rubydoc.js" type="text/javascript" charset="utf-8"></script> 

 
<script src="../js/highlight.min.js"></script>
<script> 
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
  </script> 

  <style type='text/css'>

    #vulns-alert #vulns{
      background-color: #c33 ! important;
      width: 100%;
      text-align: center;
   }
   
   #vulns-alert #vulns a {
    color: #F99 ! important;
   }
 </style>

</head>

<body id="top" class="module rdocstar">
<div id='actionbar' >
<div class='wrapper'>
  <ul class='grids g0'>
	<li class='grid-2' ><a href='/' target='_top' >Home</a></li>
	<li class='grid-2' ><a href='/core' target='_top' >Core </a></li>
	<li class='grid-2' ><a href='/stdlib' target='_top' >Std-lib </a></li>

	 <!-- li class='grid-2' ><a href='/zems' target='_top' >Zems</a></li -->
   <li class='grid-2' ><a href='/downloads' target='_top' >Downloads</a></li>
	 <li class='grid-5 right' id='rd-action-search'><form id="searchbox_011815814100681837392:wnccv6st5qk" action="http://ruby-doc.com/search.html"><input type="hidden" name="cx" value="011815814100681837392:wnccv6st5qk" ><input  id='rd-search-input' name="q" type="text" size="20" >&#160;&#160;<input type="submit" name="sa" value="Search" ><input type="hidden" name="cof" value="FORID:9" ></form></li>
	</ul>
</div>
<span id='vulns-alert'></span>
<!-- VERSION HEADER for 2_2_3 NOT FOUND --></div> <!-- end action bar -->
 <div class='wrapper'>
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
          
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul id='file-metadata'>

          
          
          
          <li class='in-file'>rubygems/install_update_options.rb</li>      
            
          
          <li class='in-file'>rubygems/package.rb</li>      
            
          
          <li class='in-file'>rubygems/package/old.rb</li>      
            
          
          <li class='in-file'>rubygems/security.rb</li>      
            
          
          <li class='in-file'>rubygems/security/policies.rb</li>      
            
          
          <li class='in-file'>rubygems/security/policy.rb</li>      
            
          
          <li class='in-file'>rubygems/security/signer.rb</li>      
            
          
          <li class='in-file'>rubygems/security/trust_dir.rb</li>      
            
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">CLASS</span> <a href="Security/Exception.html">Gem::Security::Exception</a></li>
          
          <li><span class="type">CLASS</span> <a href="Security/Policy.html">Gem::Security::Policy</a></li>
          
          <li><span class="type">CLASS</span> <a href="Security/Signer.html">Gem::Security::Signer</a></li>
          
          <li><span class="type">CLASS</span> <a href="Security/TrustDir.html">Gem::Security::TrustDir</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-alt_name_or_x509_entry">::alt_name_or_x509_entry</a></li>
          
          <li><a href="#method-c-create_cert">::create_cert</a></li>
          
          <li><a href="#method-c-create_cert_email">::create_cert_email</a></li>
          
          <li><a href="#method-c-create_cert_self_signed">::create_cert_self_signed</a></li>
          
          <li><a href="#method-c-create_key">::create_key</a></li>
          
          <li><a href="#method-c-email_to_name">::email_to_name</a></li>
          
          <li><a href="#method-c-re_sign">::re_sign</a></li>
          
          <li><a href="#method-c-reset">::reset</a></li>
          
          <li><a href="#method-c-sign">::sign</a></li>
          
          <li><a href="#method-c-trust_dir">::trust_dir</a></li>
          
          <li><a href="#method-c-trusted_certificates">::trusted_certificates</a></li>
          
          <li><a href="#method-c-write">::write</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
          
          
          
          <li><a href="../Gem/AvailableSet.html">Gem::AvailableSet</a></li>
        
          
          
          <li><a href="../Gem/BasicSpecification.html">Gem::BasicSpecification</a></li>
        
          
          
          <li><a href="../Gem/Command.html">Gem::Command</a></li>
        
          
          
          <li><a href="../Gem/CommandLineError.html">Gem::CommandLineError</a></li>
        
          
          
          <li><a href="../Gem/CommandManager.html">Gem::CommandManager</a></li>
        
          
          
          <li><a href="../Gem/Commands.html">Gem::Commands</a></li>
        
          
          
          <li><a href="../Gem/Commands/BuildCommand.html">Gem::Commands::BuildCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/CertCommand.html">Gem::Commands::CertCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/CheckCommand.html">Gem::Commands::CheckCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/CleanupCommand.html">Gem::Commands::CleanupCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/ContentsCommand.html">Gem::Commands::ContentsCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/DependencyCommand.html">Gem::Commands::DependencyCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/EnvironmentCommand.html">Gem::Commands::EnvironmentCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/FetchCommand.html">Gem::Commands::FetchCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/GenerateIndexCommand.html">Gem::Commands::GenerateIndexCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/HelpCommand.html">Gem::Commands::HelpCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/InstallCommand.html">Gem::Commands::InstallCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/ListCommand.html">Gem::Commands::ListCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/LockCommand.html">Gem::Commands::LockCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/MirrorCommand.html">Gem::Commands::MirrorCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/OpenCommand.html">Gem::Commands::OpenCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/OutdatedCommand.html">Gem::Commands::OutdatedCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/OwnerCommand.html">Gem::Commands::OwnerCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/PristineCommand.html">Gem::Commands::PristineCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/PushCommand.html">Gem::Commands::PushCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/QueryCommand.html">Gem::Commands::QueryCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/RdocCommand.html">Gem::Commands::RdocCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/SearchCommand.html">Gem::Commands::SearchCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/ServerCommand.html">Gem::Commands::ServerCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/SetupCommand.html">Gem::Commands::SetupCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/SourcesCommand.html">Gem::Commands::SourcesCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/SpecificationCommand.html">Gem::Commands::SpecificationCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/StaleCommand.html">Gem::Commands::StaleCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/UninstallCommand.html">Gem::Commands::UninstallCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/UnpackCommand.html">Gem::Commands::UnpackCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/UpdateCommand.html">Gem::Commands::UpdateCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/WhichCommand.html">Gem::Commands::WhichCommand</a></li>
        
          
          
          <li><a href="../Gem/Commands/YankCommand.html">Gem::Commands::YankCommand</a></li>
        
          
          
          <li><a href="../Gem/ConfigFile.html">Gem::ConfigFile</a></li>
        
          
          
          <li><a href="../Gem/ConfigFile/Psych.html">Gem::ConfigFile::Psych</a></li>
        
          
          
          <li><a href="../Gem/ConflictError.html">Gem::ConflictError</a></li>
        
          
          
          <li><a href="../Gem/ConsoleUI.html">Gem::ConsoleUI</a></li>
        
          
          
          <li><a href="../Gem/DefaultUserInteraction.html">Gem::DefaultUserInteraction</a></li>
        
          
          
          <li><a href="../Gem/Dependency.html">Gem::Dependency</a></li>
        
          
          
          <li><a href="../Gem/DependencyError.html">Gem::DependencyError</a></li>
        
          
          
          <li><a href="../Gem/DependencyInstaller.html">Gem::DependencyInstaller</a></li>
        
          
          
          <li><a href="../Gem/DependencyList.html">Gem::DependencyList</a></li>
        
          
          
          <li><a href="../Gem/DependencyRemovalException.html">Gem::DependencyRemovalException</a></li>
        
          
          
          <li><a href="../Gem/DependencyResolutionError.html">Gem::DependencyResolutionError</a></li>
        
          
          
          <li><a href="../Gem/Deprecate.html">Gem::Deprecate</a></li>
        
          
          
          <li><a href="../Gem/Doctor.html">Gem::Doctor</a></li>
        
          
          
          <li><a href="../Gem/DocumentError.html">Gem::DocumentError</a></li>
        
          
          
          <li><a href="../Gem/EndOfYAMLException.html">Gem::EndOfYAMLException</a></li>
        
          
          
          <li><a href="../Gem/ErrorReason.html">Gem::ErrorReason</a></li>
        
          
          
          <li><a href="../Gem/Exception.html">Gem::Exception</a></li>
        
          
          
          <li><a href="../Gem/Ext.html">Gem::Ext</a></li>
        
          
          
          <li><a href="../Gem/Ext/BuildError.html">Gem::Ext::BuildError</a></li>
        
          
          
          <li><a href="../Gem/Ext/Builder.html">Gem::Ext::Builder</a></li>
        
          
          
          <li><a href="../Gem/Ext/CmakeBuilder.html">Gem::Ext::CmakeBuilder</a></li>
        
          
          
          <li><a href="../Gem/Ext/ConfigureBuilder.html">Gem::Ext::ConfigureBuilder</a></li>
        
          
          
          <li><a href="../Gem/Ext/ExtConfBuilder.html">Gem::Ext::ExtConfBuilder</a></li>
        
          
          
          <li><a href="../Gem/Ext/RakeBuilder.html">Gem::Ext::RakeBuilder</a></li>
        
          
          
          <li><a href="../Gem/FakeFetcher.html">Gem::FakeFetcher</a></li>
        
          
          
          <li><a href="../Gem/FilePermissionError.html">Gem::FilePermissionError</a></li>
        
          
          
          <li><a href="../Gem/FormatException.html">Gem::FormatException</a></li>
        
          
          
          <li><a href="../Gem/GemNotFoundException.html">Gem::GemNotFoundException</a></li>
        
          
          
          <li><a href="../Gem/GemNotInHomeException.html">Gem::GemNotInHomeException</a></li>
        
          
          
          <li><a href="../Gem/GemRunner.html">Gem::GemRunner</a></li>
        
          
          
          <li><a href="../Gem/GemcutterUtilities.html">Gem::GemcutterUtilities</a></li>
        
          
          
          <li><a href="../Gem/ImpossibleDependenciesError.html">Gem::ImpossibleDependenciesError</a></li>
        
          
          
          <li><a href="../Gem/Indexer.html">Gem::Indexer</a></li>
        
          
          
          <li><a href="../Gem/InstallError.html">Gem::InstallError</a></li>
        
          
          
          <li><a href="../Gem/InstallUpdateOptions.html">Gem::InstallUpdateOptions</a></li>
        
          
          
          <li><a href="../Gem/Installer.html">Gem::Installer</a></li>
        
          
          
          <li><a href="../Gem/InstallerTestCase.html">Gem::InstallerTestCase</a></li>
        
          
          
          <li><a href="../Gem/InvalidSpecificationException.html">Gem::InvalidSpecificationException</a></li>
        
          
          
          <li><a href="../Gem/List.html">Gem::List</a></li>
        
          
          
          <li><a href="../Gem/LoadError.html">Gem::LoadError</a></li>
        
          
          
          <li><a href="../Gem/LocalRemoteOptions.html">Gem::LocalRemoteOptions</a></li>
        
          
          
          <li><a href="../Gem/MockGemUi.html">Gem::MockGemUi</a></li>
        
          
          
          <li><a href="../Gem/MockGemUi/InputEOFError.html">Gem::MockGemUi::InputEOFError</a></li>
        
          
          
          <li><a href="../Gem/MockGemUi/SystemExitException.html">Gem::MockGemUi::SystemExitException</a></li>
        
          
          
          <li><a href="../Gem/MockGemUi/TTY.html">Gem::MockGemUi::TTY</a></li>
        
          
          
          <li><a href="../Gem/MockGemUi/TermError.html">Gem::MockGemUi::TermError</a></li>
        
          
          
          <li><a href="../Gem/NameTuple.html">Gem::NameTuple</a></li>
        
          
          
          <li><a href="../Gem/NoAliasYAMLTree.html">Gem::NoAliasYAMLTree</a></li>
        
          
          
          <li><a href="../Gem/OperationNotSupportedError.html">Gem::OperationNotSupportedError</a></li>
        
          
          
          <li><a href="../Gem/Package/DigestIO.html">Gem::Package::DigestIO</a></li>
        
          
          
          <li><a href="../Gem/Package/Error.html">Gem::Package::Error</a></li>
        
          
          
          <li><a href="../Gem/Package/FormatError.html">Gem::Package::FormatError</a></li>
        
          
          
          <li><a href="../Gem/Package/NonSeekableIO.html">Gem::Package::NonSeekableIO</a></li>
        
          
          
          <li><a href="../Gem/Package/Old.html">Gem::Package::Old</a></li>
        
          
          
          <li><a href="../Gem/Package/PathError.html">Gem::Package::PathError</a></li>
        
          
          
          <li><a href="../Gem/Package/TarHeader.html">Gem::Package::TarHeader</a></li>
        
          
          
          <li><a href="../Gem/Package/TarInvalidError.html">Gem::Package::TarInvalidError</a></li>
        
          
          
          <li><a href="../Gem/Package/TarReader.html">Gem::Package::TarReader</a></li>
        
          
          
          <li><a href="../Gem/Package/TarReader/Entry.html">Gem::Package::TarReader::Entry</a></li>
        
          
          
          <li><a href="../Gem/Package/TarReader/UnexpectedEOF.html">Gem::Package::TarReader::UnexpectedEOF</a></li>
        
          
          
          <li><a href="../Gem/Package/TarTestCase.html">Gem::Package::TarTestCase</a></li>
        
          
          
          <li><a href="../Gem/Package/TarWriter.html">Gem::Package::TarWriter</a></li>
        
          
          
          <li><a href="../Gem/Package/TarWriter/BoundedStream.html">Gem::Package::TarWriter::BoundedStream</a></li>
        
          
          
          <li><a href="../Gem/Package/TarWriter/FileOverflow.html">Gem::Package::TarWriter::FileOverflow</a></li>
        
          
          
          <li><a href="../Gem/Package/TarWriter/RestrictedStream.html">Gem::Package::TarWriter::RestrictedStream</a></li>
        
          
          
          <li><a href="../Gem/Package/TooLongFileName.html">Gem::Package::TooLongFileName</a></li>
        
          
          
          <li><a href="../Gem/PackageTask.html">Gem::PackageTask</a></li>
        
          
          
          <li><a href="../Gem/PathSupport.html">Gem::PathSupport</a></li>
        
          
          
          <li><a href="../Gem/Platform.html">Gem::Platform</a></li>
        
          
          
          <li><a href="../Gem/PlatformMismatch.html">Gem::PlatformMismatch</a></li>
        
          
          
          <li><a href="../Gem/RemoteError.html">Gem::RemoteError</a></li>
        
          
          
          <li><a href="../Gem/RemoteFetcher.html">Gem::RemoteFetcher</a></li>
        
          
          
          <li><a href="../Gem/RemoteFetcher/FetchError.html">Gem::RemoteFetcher::FetchError</a></li>
        
          
          
          <li><a href="../Gem/RemoteFetcher/UnknownHostError.html">Gem::RemoteFetcher::UnknownHostError</a></li>
        
          
          
          <li><a href="../Gem/RemoteInstallationCancelled.html">Gem::RemoteInstallationCancelled</a></li>
        
          
          
          <li><a href="../Gem/RemoteInstallationSkipped.html">Gem::RemoteInstallationSkipped</a></li>
        
          
          
          <li><a href="../Gem/RemoteSourceException.html">Gem::RemoteSourceException</a></li>
        
          
          
          <li><a href="../Gem/Request/ConnectionPools.html">Gem::Request::ConnectionPools</a></li>
        
          
          
          <li><a href="../Gem/Request/ConnectionPools/Net.html">Gem::Request::ConnectionPools::Net</a></li>
        
          
          
          <li><a href="../Gem/RequestSet.html">Gem::RequestSet</a></li>
        
          
          
          <li><a href="../Gem/RequestSet/GemDependencyAPI.html">Gem::RequestSet::GemDependencyAPI</a></li>
        
          
          
          <li><a href="../Gem/RequestSet/Lockfile.html">Gem::RequestSet::Lockfile</a></li>
        
          
          
          <li><a href="../Gem/RequestSet/Lockfile/ParseError.html">Gem::RequestSet::Lockfile::ParseError</a></li>
        
          
          
          <li><a href="../Gem/Requirement.html">Gem::Requirement</a></li>
        
          
          
          <li><a href="../Gem/Requirement/BadRequirementError.html">Gem::Requirement::BadRequirementError</a></li>
        
          
          
          <li><a href="../Gem/Resolver.html">Gem::Resolver</a></li>
        
          
          
          <li><a href="../Gem/Resolver/APISet.html">Gem::Resolver::APISet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/APISpecification.html">Gem::Resolver::APISpecification</a></li>
        
          
          
          <li><a href="../Gem/Resolver/ActivationRequest.html">Gem::Resolver::ActivationRequest</a></li>
        
          
          
          <li><a href="../Gem/Resolver/BestSet.html">Gem::Resolver::BestSet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/ComposedSet.html">Gem::Resolver::ComposedSet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/Conflict.html">Gem::Resolver::Conflict</a></li>
        
          
          
          <li><a href="../Gem/Resolver/CurrentSet.html">Gem::Resolver::CurrentSet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/DependencyRequest.html">Gem::Resolver::DependencyRequest</a></li>
        
          
          
          <li><a href="../Gem/Resolver/GitSet.html">Gem::Resolver::GitSet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/GitSpecification.html">Gem::Resolver::GitSpecification</a></li>
        
          
          
          <li><a href="../Gem/Resolver/IndexSet.html">Gem::Resolver::IndexSet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/IndexSpecification.html">Gem::Resolver::IndexSpecification</a></li>
        
          
          
          <li><a href="../Gem/Resolver/InstalledSpecification.html">Gem::Resolver::InstalledSpecification</a></li>
        
          
          
          <li><a href="../Gem/Resolver/InstallerSet.html">Gem::Resolver::InstallerSet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/LocalSpecification.html">Gem::Resolver::LocalSpecification</a></li>
        
          
          
          <li><a href="../Gem/Resolver/LockSet.html">Gem::Resolver::LockSet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/LockSpecification.html">Gem::Resolver::LockSpecification</a></li>
        
          
          
          <li><a href="../Gem/Resolver/RequirementList.html">Gem::Resolver::RequirementList</a></li>
        
          
          
          <li><a href="../Gem/Resolver/Set.html">Gem::Resolver::Set</a></li>
        
          
          
          <li><a href="../Gem/Resolver/SpecSpecification.html">Gem::Resolver::SpecSpecification</a></li>
        
          
          
          <li><a href="../Gem/Resolver/Specification.html">Gem::Resolver::Specification</a></li>
        
          
          
          <li><a href="../Gem/Resolver/Stats.html">Gem::Resolver::Stats</a></li>
        
          
          
          <li><a href="../Gem/Resolver/VendorSet.html">Gem::Resolver::VendorSet</a></li>
        
          
          
          <li><a href="../Gem/Resolver/VendorSpecification.html">Gem::Resolver::VendorSpecification</a></li>
        
          
          
          <li><a href="../Gem/RubyVersionMismatch.html">Gem::RubyVersionMismatch</a></li>
        
          
          
          <li><a href="../Gem/Security.html">Gem::Security</a></li>
        
          
          
          <li><a href="../Gem/Security/Exception.html">Gem::Security::Exception</a></li>
        
          
          
          <li><a href="../Gem/Security/Policy.html">Gem::Security::Policy</a></li>
        
          
          
          <li><a href="../Gem/Security/Signer.html">Gem::Security::Signer</a></li>
        
          
          
          <li><a href="../Gem/Security/TrustDir.html">Gem::Security::TrustDir</a></li>
        
          
          
          <li><a href="../Gem/Server.html">Gem::Server</a></li>
        
          
          
          <li><a href="../Gem/SilentUI.html">Gem::SilentUI</a></li>
        
          
          
          <li><a href="../Gem/Source.html">Gem::Source</a></li>
        
          
          
          <li><a href="../Gem/Source/Git.html">Gem::Source::Git</a></li>
        
          
          
          <li><a href="../Gem/Source/Installed.html">Gem::Source::Installed</a></li>
        
          
          
          <li><a href="../Gem/Source/Local.html">Gem::Source::Local</a></li>
        
          
          
          <li><a href="../Gem/Source/Lock.html">Gem::Source::Lock</a></li>
        
          
          
          <li><a href="../Gem/Source/SpecificFile.html">Gem::Source::SpecificFile</a></li>
        
          
          
          <li><a href="../Gem/Source/Vendor.html">Gem::Source::Vendor</a></li>
        
          
          
          <li><a href="../Gem/SourceFetchProblem.html">Gem::SourceFetchProblem</a></li>
        
          
          
          <li><a href="../Gem/SourceList.html">Gem::SourceList</a></li>
        
          
          
          <li><a href="../Gem/SpecFetcher.html">Gem::SpecFetcher</a></li>
        
          
          
          <li><a href="../Gem/SpecificGemNotFoundException.html">Gem::SpecificGemNotFoundException</a></li>
        
          
          
          <li><a href="../Gem/Specification.html">Gem::Specification</a></li>
        
          
          
          <li><a href="../Gem/StreamUI.html">Gem::StreamUI</a></li>
        
          
          
          <li><a href="../Gem/StreamUI/SilentDownloadReporter.html">Gem::StreamUI::SilentDownloadReporter</a></li>
        
          
          
          <li><a href="../Gem/StreamUI/SilentProgressReporter.html">Gem::StreamUI::SilentProgressReporter</a></li>
        
          
          
          <li><a href="../Gem/StreamUI/SimpleProgressReporter.html">Gem::StreamUI::SimpleProgressReporter</a></li>
        
          
          
          <li><a href="../Gem/StreamUI/VerboseDownloadReporter.html">Gem::StreamUI::VerboseDownloadReporter</a></li>
        
          
          
          <li><a href="../Gem/StreamUI/VerboseProgressReporter.html">Gem::StreamUI::VerboseProgressReporter</a></li>
        
          
          
          <li><a href="../Gem/StringSink.html">Gem::StringSink</a></li>
        
          
          
          <li><a href="../Gem/StringSource.html">Gem::StringSource</a></li>
        
          
          
          <li><a href="../Gem/StubSpecification.html">Gem::StubSpecification</a></li>
        
          
          
          <li><a href="../Gem/SystemExitException.html">Gem::SystemExitException</a></li>
        
          
          
          <li><a href="../Gem/TestCase.html">Gem::TestCase</a></li>
        
          
          
          <li><a href="../Gem/TestCase/SpecFetcherSetup.html">Gem::TestCase::SpecFetcherSetup</a></li>
        
          
          
          <li><a href="../Gem/TestCase/StaticSet.html">Gem::TestCase::StaticSet</a></li>
        
          
          
          <li><a href="../Gem/Text.html">Gem::Text</a></li>
        
          
          
          <li><a href="../Gem/Uninstaller.html">Gem::Uninstaller</a></li>
        
          
          
          <li><a href="../Gem/UnsatisfiableDependencyError.html">Gem::UnsatisfiableDependencyError</a></li>
        
          
          
          <li><a href="../Gem/UriFormatter.html">Gem::UriFormatter</a></li>
        
          
          
          <li><a href="../Gem/UserInteraction.html">Gem::UserInteraction</a></li>
        
          
          
          <li><a href="../Gem/Util.html">Gem::Util</a></li>
        
          
          
          <li><a href="../Gem/Validator.html">Gem::Validator</a></li>
        
          
          
          <li><a href="../Gem/VerificationError.html">Gem::VerificationError</a></li>
        
          
          
          <li><a href="../Gem/Version.html">Gem::Version</a></li>
        
          
          
          <li><a href="../Gem/VersionOption.html">Gem::VersionOption</a></li>
        
          
          
          <li><a href="../Kernel.html">Kernel</a></li>
        
          
          
          <li><a href="../Object.html">Object</a></li>
        
          
          
          <li><a href="../OpenSSL.html">OpenSSL</a></li>
        
          
          
          <li><a href="../TempIO.html">TempIO</a></li>
        
          
          
          <li><a href="../YAML/Syck.html">YAML::Syck</a></li>
        
          
          
          <li><a href="../YAML/Syck.html">YAML::Syck</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div> <!-- metadata -->
  <div class='adzbox'  id="azk83167">
    
   <div id="carbonads-container"><div class="carbonad"><div id="azcarbon"></div><script type="text/javascript">var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = "http://engine.carbonads.com/z/19647/azcarbon_2_1_0_VERT"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script></div></div>
<script type="text/javascript">
  function checkCarbs() {
    var searchFor = ".car" + "bona" + "d-tag";
    var ctext = $(searchFor);
    if (!ctext.length ) {
     // alert("Cannot find element with class " + searchFor );
      $("#azcarbon").append("<div class='rd-ab-msg'>If you are running an ad blocker please consider white-listing ruby-doc.org. <br><br>Thank you.</div>");
    }
  }
//  window.setTimeout(checkCarbs,3000); 
</script>

   
  </div> 
  <div id="documentation">
    <h1 class="module">Gem::Security</h1>

    <div id="description" class="description">
      
<h1 id="module-Gem::Security-label-Signing+gems">Signing gems<span><a href="#module-Gem::Security-label-Signing+gems">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>The <a href="Security.html">Gem::Security</a> implements cryptographic
signatures for gems.  The section below is a step-by-step guide to using
signed gems and generating your own.</p>

<h2 id="module-Gem::Security-label-Walkthrough">Walkthrough<span><a href="#module-Gem::Security-label-Walkthrough">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="module-Gem::Security-label-Building+your+certificate">Building your certificate<span><a href="#module-Gem::Security-label-Building+your+certificate">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>In order to start signing your gems, you’ll need to build a private key and
a self-signed certificate.  Here’s how:</p>

<pre># build a private key and certificate for yourself:
$ gem cert --build you@example.com</pre>

<p>This could take anywhere from a few seconds to a minute or two, depending
on the speed of your computer (public key algorithms aren’t exactly the
speediest crypto algorithms in the world).  When it’s finished, you’ll see
the files “gem-private_key.pem” and “gem-public_cert.pem” in the current
directory.</p>

<p>First things first: Move both files to ~/.gem if you don’t already have a
key and certificate in that directory.  Ensure the file permissions make
the key unreadable by others (by default the file is saved securely).</p>

<p>Keep your private key hidden; if it’s compromised, someone can sign
packages as you (note: PKI has ways of mitigating the risk of stolen keys;
more on that later).</p>

<h3 id="module-Gem::Security-label-Signing+Gems">Signing Gems<span><a href="#module-Gem::Security-label-Signing+Gems">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>In RubyGems 2 and newer there is no extra work to sign a gem.  RubyGems
will automatically find your key and certificate in your home directory and
use them to sign newly packaged gems.</p>

<p>If your certificate is not self-signed (signed by a third party) RubyGems
will attempt to load the certificate chain from the trusted certificates.
Use <code>gem cert --add signing_cert.pem</code> to add your signers as
trusted certificates.  See below for further information on certificate
chains.</p>

<p>If you build your gem it will automatically be signed.  If you peek inside
your gem file, you’ll see a couple of new files have been added:</p>

<pre>$ tar tf your-gem-1.0.gem
metadata.gz
metadata.gz.sum
metadata.gz.sig # metadata signature
data.tar.gz
data.tar.gz.sum
data.tar.gz.sig # data signature</pre>

<h3 id="module-Gem::Security-label-Manually+signing+gems">Manually signing gems<span><a href="#module-Gem::Security-label-Manually+signing+gems">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you wish to store your key in a separate secure location you’ll need to
set your gems up for signing by hand.  To do this, set the
<code>signing_key</code> and <code>cert_chain</code> in the gemspec before
packaging your gem:</p>

<pre class="ruby"><span class="ruby-identifier">s</span>.<span class="ruby-identifier">signing_key</span> = <span class="ruby-string">'/secure/path/to/gem-private_key.pem'</span>
<span class="ruby-identifier">s</span>.<span class="ruby-identifier">cert_chain</span> = <span class="ruby-node">%w[/secure/path/to/gem-public_cert.pem]</span>
</pre>

<p>When you package your gem with these options set RubyGems will
automatically load your key and certificate from the secure paths.</p>

<h3 id="module-Gem::Security-label-Signed+gems+and+security+policies">Signed gems and security policies<span><a href="#module-Gem::Security-label-Signed+gems+and+security+policies">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Now let’s verify the signature.  Go ahead and install the gem, but add the
following options: <code>-P HighSecurity</code>, like this:</p>

<pre># install the gem with using the security policy &quot;HighSecurity&quot;
$ sudo gem install your.gem -P HighSecurity</pre>

<p>The <code>-P</code> option sets your security policy – we’ll talk about
that in just a minute.  Eh, what’s this?</p>

<pre>$ gem install -P HighSecurity your-gem-1.0.gem
ERROR:  While executing gem ... (Gem::Security::Exception)
    root cert /CN=you/DC=example is not trusted</pre>

<p>The culprit here is the security policy.  RubyGems has several different
security policies.  Let’s take a short break and go over the security
policies.  Here’s a list of the available security policies, and a brief
description of each one:</p>
<ul><li>
<p><a href="Security.html#NoSecurity">NoSecurity</a> - Well, no security at
all.  Signed packages are treated like unsigned packages.</p>
</li><li>
<p><a href="Security.html#LowSecurity">LowSecurity</a> - Pretty much no
security.  If a package is signed then RubyGems will make sure the
signature matches the signing certificate, and that the signing certificate
hasn't expired, but that's it.  A malicious user could easily circumvent
this kind of security.</p>
</li><li>
<p><a href="Security.html#MediumSecurity">MediumSecurity</a> - Better than <a
href="Security.html#LowSecurity">LowSecurity</a> and <a
href="Security.html#NoSecurity">NoSecurity</a>, but still fallible. 
Package contents are verified against the signing certificate, and the
signing certificate is checked for validity, and checked against the rest
of the certificate chain (if you don't know what a certificate chain is,
stay tuned, we'll get to that). The biggest improvement over <a
href="Security.html#LowSecurity">LowSecurity</a> is that <a
href="Security.html#MediumSecurity">MediumSecurity</a> won't install
packages that are signed by untrusted sources. Unfortunately, <a
href="Security.html#MediumSecurity">MediumSecurity</a> still isn't totally
secure -- a malicious user can still unpack the gem, strip the signatures,
and distribute the gem unsigned.</p>
</li><li>
<p><a href="Security.html#HighSecurity">HighSecurity</a> - Here's the bugger
that got us into this mess. The <a
href="Security.html#HighSecurity">HighSecurity</a> policy is identical to
the <a href="Security.html#MediumSecurity">MediumSecurity</a> policy,
except that it does not allow unsigned gems.  A malicious user doesn't have
a whole lot of options here; they can't modify the package contents without
invalidating the signature, and they can't modify or remove signature or
the signing certificate chain, or RubyGems will simply refuse to install
the package.  Oh well, maybe they'll have better luck causing problems for
CPAN users instead :).</p>
</li></ul>

<p>The reason RubyGems refused to install your shiny new signed gem was
because it was from an untrusted source.  Well, your code is infallible
(naturally), so you need to add yourself as a trusted source:</p>

<pre># add trusted certificate
gem cert --add ~/.gem/gem-public_cert.pem</pre>

<p>You’ve now added your public certificate as a trusted source.  Now you can
install packages signed by your private key without any hassle.  Let’s try
the install command above again:</p>

<pre># install the gem with using the HighSecurity policy (and this time
# without any shenanigans)
$ gem install -P HighSecurity your-gem-1.0.gem
Successfully installed your-gem-1.0
1 gem installed</pre>

<p>This time RubyGems will accept your signed package and begin installing.</p>

<p>While you’re waiting for RubyGems to work it’s magic, have a look at some
of the other security commands by running <code>gem help cert</code>:</p>

<pre>Options:
  -a, --add CERT                   Add a trusted certificate.
  -l, --list [FILTER]              List trusted certificates where the
                                   subject contains FILTER
  -r, --remove FILTER              Remove trusted certificates where the
                                   subject contains FILTER
  -b, --build EMAIL_ADDR           Build private key and self-signed
                                   certificate for EMAIL_ADDR
  -C, --certificate CERT           Signing certificate for --sign
  -K, --private-key KEY            Key for --sign or --build
  -s, --sign CERT                  Signs CERT with the key from -K
                                   and the certificate from -C</pre>

<p>We’ve already covered the <code>--build</code> option, and the
<code>--add</code>, <code>--list</code>, and <code>--remove</code> commands
seem fairly straightforward; they allow you to add, list, and remove the
certificates in your trusted certificate list.  But what’s with this
<code>--sign</code> option?</p>

<h3 id="module-Gem::Security-label-Certificate+chains">Certificate chains<span><a href="#module-Gem::Security-label-Certificate+chains">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>To answer that question, let’s take a look at “certificate chains”, a
concept I mentioned earlier.  There are a couple of problems with
self-signed certificates: first of all, self-signed certificates don’t
offer a whole lot of security.  Sure, the certificate says Yukihiro
Matsumoto, but how do I know it was actually generated and signed by matz
himself unless he gave me the certificate in person?</p>

<p>The second problem is scalability.  Sure, if there are 50 gem authors, then
I have 50 trusted certificates, no problem.  What if there are 500 gem
authors?  1000?  Having to constantly add new trusted certificates is a
pain, and it actually makes the trust system less secure by encouraging
RubyGems users to blindly trust new certificates.</p>

<p>Here’s where certificate chains come in.  A certificate chain establishes
an arbitrarily long chain of trust between an issuing certificate and a
child certificate.  So instead of trusting certificates on a per-developer
basis, we use the PKI concept of certificate chains to build a logical
hierarchy of trust.  Here’s a hypothetical example of a trust hierarchy
based (roughly) on geography:</p>

<pre>                    --------------------------
                    | rubygems@rubygems.org |
                    --------------------------
                                |
              -----------------------------------
              |                                 |
  ----------------------------    -----------------------------
  |  seattlerb@seattlerb.org |    | dcrubyists@richkilmer.com |
  ----------------------------    -----------------------------
       |                |                 |             |
---------------   ----------------   -----------   --------------
|   drbrain   |   |   zenspider  |   | pabs@dc |   | tomcope@dc |
---------------   ----------------   -----------   --------------</pre>

<p>Now, rather than having 4 trusted certificates (one for drbrain, zenspider,
pabs@dc, and tomecope@dc), a user could actually get by with one
certificate, the “rubygems@rubygems.org” certificate.</p>

<p>Here’s how it works:</p>

<p>I install “rdoc-3.12.gem”, a package signed by “drbrain”.  I’ve never heard
of “drbrain”, but his certificate has a valid signature from the
“seattle.rb@seattlerb.org” certificate, which in turn has a valid signature
from the “rubygems@rubygems.org” certificate.  Voila!  At this point, it’s
much more reasonable for me to trust a package signed by “drbrain”, because
I can establish a chain to “rubygems@rubygems.org”, which I do trust.</p>

<h3 id="module-Gem::Security-label-Signing+certificates">Signing certificates<span><a href="#module-Gem::Security-label-Signing+certificates">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The <code>--sign</code> option allows all this to happen.  A developer
creates their build certificate with the <code>--build</code> option, then
has their certificate signed by taking it with them to their next regional
Ruby meetup (in our hypothetical example), and it’s signed there by the
person holding the regional RubyGems signing certificate, which is signed
at the next RubyConf by the holder of the top-level RubyGems certificate. 
At each point the issuer runs the same command:</p>

<pre># sign a certificate with the specified key and certificate
# (note that this modifies client_cert.pem!)
$ gem cert -K /mnt/floppy/issuer-priv_key.pem -C issuer-pub_cert.pem
   --sign client_cert.pem</pre>

<p>Then the holder of issued certificate (in this case, your buddy “drbrain”),
can start using this signed certificate to sign RubyGems.  By the way, in
order to let everyone else know about his new fancy signed certificate,
“drbrain” would save his newly signed certificate as
<code>~/.gem/gem-public_cert.pem</code></p>

<p>Obviously this RubyGems trust infrastructure doesn’t exist yet.  Also, in
the “real world”, issuers actually generate the child certificate from a
certificate request, rather than sign an existing certificate.  And our
hypothetical infrastructure is missing a certificate revocation system.
These are that can be fixed in the future…</p>

<p>At this point you should know how to do all of these new and interesting
things:</p>
<ul><li>
<p>build a gem signing key and certificate</p>
</li><li>
<p>adjust your security policy</p>
</li><li>
<p>modify your trusted certificate list</p>
</li><li>
<p>sign a certificate</p>
</li></ul>

<h2 id="module-Gem::Security-label-Manually+verifying+signatures">Manually verifying signatures<span><a href="#module-Gem::Security-label-Manually+verifying+signatures">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>In case you don’t trust RubyGems you can verify gem signatures manually:</p>
<ol><li>
<p>Fetch and unpack the gem</p>

<pre>gem fetch some_signed_gem
tar -xf some_signed_gem-1.0.gem</pre>
</li><li>
<p>Grab the public key from the gemspec</p>

<pre>gem spec some_signed_gem-1.0.gem cert_chain | \
  ruby -ryaml -e 'puts YAML.load_documents($stdin)' &gt; public_key.crt</pre>
</li><li>
<p>Generate a SHA1 hash of the data.tar.gz</p>

<pre class="ruby"><span class="ruby-identifier">openssl</span> <span class="ruby-identifier">dgst</span> <span class="ruby-operator">-</span><span class="ruby-identifier">sha1</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">tar</span>.<span class="ruby-identifier">gz</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">my</span>.<span class="ruby-identifier">hash</span>
</pre>
</li><li>
<p>Verify the signature</p>

<pre>openssl rsautl -verify -inkey public_key.crt -certin \
  -in data.tar.gz.sig &gt; verified.hash</pre>
</li><li>
<p>Compare your hash to the verified hash</p>

<pre>diff -s verified.hash my.hash</pre>
</li><li>
<p>Repeat 5 and 6 with metadata.gz</p>
</li></ol>

<h2 id="module-Gem::Security-label-OpenSSL+Reference"><a href="../OpenSSL.html">OpenSSL</a> Reference<span><a href="#module-Gem::Security-label-OpenSSL+Reference">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The .pem files generated by –build and –sign are PEM files.  Here’s a
couple of useful <a href="../OpenSSL.html">OpenSSL</a> commands for
manipulating them:</p>

<pre># convert a PEM format X509 certificate into DER format:
# (note: Windows .cer files are X509 certificates in DER format)
$ openssl x509 -in input.pem -outform der -out output.der

# print out the certificate in a human-readable format:
$ openssl x509 -in input.pem -noout -text</pre>

<p>And you can do the same thing with the private key file as well:</p>

<pre># convert a PEM format RSA key into DER format:
$ openssl rsa -in input_key.pem -outform der -out output_key.der

# print out the key in a human readable format:
$ openssl rsa -in input_key.pem -noout -text</pre>

<h2 id="module-Gem::Security-label-Bugs-2FTODO">Bugs/TODO<span><a href="#module-Gem::Security-label-Bugs-2FTODO">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p>There’s no way to define a system-wide trust list.</p>
</li><li>
<p>custom security policies (from a YAML file, etc)</p>
</li><li>
<p>Simple method to generate a signed certificate request</p>
</li><li>
<p>Support for OCSP, SCVP, CRLs, or some other form of cert status check (list
is in order of preference)</p>
</li><li>
<p>Support for encrypted private keys</p>
</li><li>
<p>Some sort of semi-formal trust hierarchy (see long-winded explanation
above)</p>
</li><li>
<p>Path discovery (for gem certificate chains that don’t have a self-signed
root) – by the way, since we don’t have this, THE ROOT OF THE CERTIFICATE
CHAIN MUST BE SELF SIGNED if <a
href="Security/Policy.html#attribute-i-verify_root">Gem::Security::Policy#verify_root</a>
is true (and it is for the <a
href="Security.html#MediumSecurity">MediumSecurity</a> and <a
href="Security.html#HighSecurity">HighSecurity</a> policies)</p>
</li><li>
<p>Better explanation of X509 naming (ie, we don’t have to use email
addresses)</p>
</li><li>
<p>Honor AIA field (see note about OCSP above)</p>
</li><li>
<p>Honor extension restrictions</p>
</li><li>
<p>Might be better to store the certificate chain as a PKCS#7 or PKCS#12 file,
instead of an array embedded in the metadata.</p>
</li><li>
<p>Flexible signature and key algorithms, not hard-coded to RSA and SHA1.</p>
</li></ul>

<h2 id="module-Gem::Security-label-Original+author">Original author<span><a href="#module-Gem::Security-label-Original+author">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Paul Duncan &lt;pabs@pablotron.org&gt; <a
href="http://pablotron.org">pablotron.org</a>/</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="AlmostNoSecurity">AlmostNoSecurity</a></dt>
          
          <dd class="description"><p>AlmostNo security policy: only verify that the signing certificate is the
one that actually signed the data.  Make no attempt to verify the signing
certificate chain.</p>

<p>This policy is basically useless. better than nothing, but can still be
easily spoofed, and is not recommended.</p></dd>
          
        
          <dt><a name="DIGEST_ALGORITHM">DIGEST_ALGORITHM</a></dt>
          
          <dd class="description"><p>Digest algorithm used to sign gems</p></dd>
          
        
          <dt><a name="EXTENSIONS">EXTENSIONS</a></dt>
          
          <dd class="description"><p>The default set of extensions are:</p>
<ul><li>
<p>The certificate is not a certificate authority</p>
</li><li>
<p>The key for the certificate may be used for key and data encipherment and
digital signatures</p>
</li><li>
<p>The certificate contains a subject key identifier</p>
</li></ul></dd>
          
        
          <dt><a name="HighSecurity">HighSecurity</a></dt>
          
          <dd class="description"><p>High security policy: only allow signed gems to be installed, verify the
signing certificate, verify the signing certificate chain all the way to
the root certificate, and only trust root certificates that we have
explicitly allowed trust for.</p>

<p>This security policy is significantly more difficult to bypass, and offers
a reasonable guarantee that the contents of the gem have not been altered.</p></dd>
          
        
          <dt><a name="KEY_ALGORITHM">KEY_ALGORITHM</a></dt>
          
          <dd class="description"><p>Algorithm for creating the key pair used to sign gems</p></dd>
          
        
          <dt><a name="KEY_CIPHER">KEY_CIPHER</a></dt>
          
          <dd class="description"><p>Cipher used to encrypt the key pair used to sign gems. Must be in the list
returned by OpenSSL::Cipher.ciphers</p></dd>
          
        
          <dt><a name="KEY_LENGTH">KEY_LENGTH</a></dt>
          
          <dd class="description"><p>Length of keys created by <a
href="Security.html#KEY_ALGORITHM">KEY_ALGORITHM</a></p></dd>
          
        
          <dt><a name="LowSecurity">LowSecurity</a></dt>
          
          <dd class="description"><p>Low security policy: only verify that the signing certificate is actually
the gem signer, and that the signing certificate is valid.</p>

<p>This policy is better than nothing, but can still be easily spoofed, and is
not recommended.</p></dd>
          
        
          <dt><a name="MediumSecurity">MediumSecurity</a></dt>
          
          <dd class="description"><p>Medium security policy: verify the signing certificate, verify the signing
certificate chain all the way to the root certificate, and only trust root
certificates that we have explicitly allowed trust for.</p>

<p>This security policy is reasonable, but it allows unsigned packages, so a
malicious person could simply delete the package signature and pass the gem
off as unsigned.</p></dd>
          
        
          <dt><a name="NoSecurity">NoSecurity</a></dt>
          
          <dd class="description"><p>No security policy: all package signature checks are disabled.</p></dd>
          
        
          <dt><a name="ONE_YEAR">ONE_YEAR</a></dt>
          
          <dd class="description"><p>One year in seconds</p></dd>
          
        
          <dt><a name="Policies">Policies</a></dt>
          
          <dd class="description"><p>Hash of configured security policies</p></dd>
          
        
          <dt><a name="SigningPolicy">SigningPolicy</a></dt>
          
          <dd class="description"><p><a href="Security/Policy.html">Policy</a> used to verify a certificate and
key when signing a gem</p></dd>
          
        
        </dl>
      </div>
      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="alt_name_or_x509_entry-method" class="method-detail ">
          <a name="method-c-alt_name_or_x509_entry"></a>

          
          <div class="method-heading">
            <span class="method-name">alt_name_or_x509_entry</span><span
              class="method-args">(certificate, x509_entry)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            
            

            
            <div class="method-source-code" id="alt_name_or_x509_entry-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 393</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">alt_name_or_x509_entry</span> <span class="ruby-identifier">certificate</span>, <span class="ruby-identifier">x509_entry</span>
  <span class="ruby-identifier">alt_name</span> = <span class="ruby-identifier">certificate</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">find</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">extension</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">extension</span>.<span class="ruby-identifier">oid</span> <span class="ruby-operator">==</span> <span class="ruby-node">&quot;#{x509_entry}AltName&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">alt_name</span>.<span class="ruby-identifier">value</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">alt_name</span>

  <span class="ruby-identifier">certificate</span>.<span class="ruby-identifier">send</span> <span class="ruby-identifier">x509_entry</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- alt_name_or_x509_entry-source -->
            
          </div>

          

          
        </div><!-- alt_name_or_x509_entry-method -->
      
        <div id="create_cert-method" class="method-detail ">
          <a name="method-c-create_cert"></a>

          
          <div class="method-heading">
            <span class="method-name">create_cert</span><span
              class="method-args">(subject, key, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Creates an unsigned certificate for <code>subject</code> and
<code>key</code>.  The lifetime of the key is from the current time to
<code>age</code> which defaults to one year.</p>

<p>The <code>extensions</code> restrict the key to the indicated uses.</p>
            

            
            <div class="method-source-code" id="create_cert-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 409</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">create_cert</span> <span class="ruby-identifier">subject</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">age</span> = <span class="ruby-constant">ONE_YEAR</span>, <span class="ruby-identifier">extensions</span> = <span class="ruby-constant">EXTENSIONS</span>,
                     <span class="ruby-identifier">serial</span> = <span class="ruby-value">1</span>
  <span class="ruby-identifier">cert</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">X509</span><span class="ruby-operator">::</span><span class="ruby-constant">Certificate</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">public_key</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">public_key</span>
  <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">version</span>    = <span class="ruby-value">2</span>
  <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">serial</span>     = <span class="ruby-identifier">serial</span>

  <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">not_before</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">not_after</span>  = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">age</span>

  <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">subject</span>    = <span class="ruby-identifier">subject</span>

  <span class="ruby-identifier">ef</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">X509</span><span class="ruby-operator">::</span><span class="ruby-constant">ExtensionFactory</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">cert</span>

  <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">extensions</span> = <span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ext_name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ef</span>.<span class="ruby-identifier">create_extension</span> <span class="ruby-identifier">ext_name</span>, <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">cert</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- create_cert-source -->
            
          </div>

          

          
        </div><!-- create_cert-method -->
      
        <div id="create_cert_email-method" class="method-detail ">
          <a name="method-c-create_cert_email"></a>

          
          <div class="method-heading">
            <span class="method-name">create_cert_email</span><span
              class="method-args">(email, key, age = ONE_YEAR, extensions = EXTENSIONS)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Creates a self-signed certificate with an issuer and subject from
<code>email</code>, a subject alternative name of <code>email</code> and
the given <code>extensions</code> for the <code>key</code>.</p>
            

            
            <div class="method-source-code" id="create_cert_email-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 436</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">create_cert_email</span> <span class="ruby-identifier">email</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">age</span> = <span class="ruby-constant">ONE_YEAR</span>, <span class="ruby-identifier">extensions</span> = <span class="ruby-constant">EXTENSIONS</span>
  <span class="ruby-identifier">subject</span> = <span class="ruby-identifier">email_to_name</span> <span class="ruby-identifier">email</span>

  <span class="ruby-identifier">extensions</span> = <span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">merge</span> <span class="ruby-string">&quot;subjectAltName&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;email:#{email}&quot;</span>

  <span class="ruby-identifier">create_cert_self_signed</span> <span class="ruby-identifier">subject</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">age</span>, <span class="ruby-identifier">extensions</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- create_cert_email-source -->
            
          </div>

          

          
        </div><!-- create_cert_email-method -->
      
        <div id="create_cert_self_signed-method" class="method-detail ">
          <a name="method-c-create_cert_self_signed"></a>

          
          <div class="method-heading">
            <span class="method-name">create_cert_self_signed</span><span
              class="method-args">(subject, key, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Creates a self-signed certificate with an issuer and subject of
<code>subject</code> and the given <code>extensions</code> for the
<code>key</code>.</p>
            

            
            <div class="method-source-code" id="create_cert_self_signed-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 448</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">create_cert_self_signed</span> <span class="ruby-identifier">subject</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">age</span> = <span class="ruby-constant">ONE_YEAR</span>,
                                 <span class="ruby-identifier">extensions</span> = <span class="ruby-constant">EXTENSIONS</span>, <span class="ruby-identifier">serial</span> = <span class="ruby-value">1</span>
  <span class="ruby-identifier">certificate</span> = <span class="ruby-identifier">create_cert</span> <span class="ruby-identifier">subject</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">age</span>, <span class="ruby-identifier">extensions</span>

  <span class="ruby-identifier">sign</span> <span class="ruby-identifier">certificate</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">certificate</span>, <span class="ruby-identifier">age</span>, <span class="ruby-identifier">extensions</span>, <span class="ruby-identifier">serial</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- create_cert_self_signed-source -->
            
          </div>

          

          
        </div><!-- create_cert_self_signed-method -->
      
        <div id="create_key-method" class="method-detail ">
          <a name="method-c-create_key"></a>

          
          <div class="method-heading">
            <span class="method-name">create_key</span><span
              class="method-args">(length = KEY_LENGTH, algorithm = KEY_ALGORITHM)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Creates a new key pair of the specified <code>length</code> and
<code>algorithm</code>.  The default is a 2048 bit RSA key.</p>
            

            
            <div class="method-source-code" id="create_key-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 459</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">create_key</span> <span class="ruby-identifier">length</span> = <span class="ruby-constant">KEY_LENGTH</span>, <span class="ruby-identifier">algorithm</span> = <span class="ruby-constant">KEY_ALGORITHM</span>
  <span class="ruby-identifier">algorithm</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- create_key-source -->
            
          </div>

          

          
        </div><!-- create_key-method -->
      
        <div id="email_to_name-method" class="method-detail ">
          <a name="method-c-email_to_name"></a>

          
          <div class="method-heading">
            <span class="method-name">email_to_name</span><span
              class="method-args">(email_address)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Turns <code>email_address</code> into an OpenSSL::X509::Name</p>
            

            
            <div class="method-source-code" id="email_to_name-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 466</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">email_to_name</span> <span class="ruby-identifier">email_address</span>
  <span class="ruby-identifier">email_address</span> = <span class="ruby-identifier">email_address</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/[^\w@.-]+/i</span>, <span class="ruby-string">'_'</span>)

  <span class="ruby-identifier">cn</span>, <span class="ruby-identifier">dcs</span> = <span class="ruby-identifier">email_address</span>.<span class="ruby-identifier">split</span> <span class="ruby-string">'@'</span>

  <span class="ruby-identifier">dcs</span> = <span class="ruby-identifier">dcs</span>.<span class="ruby-identifier">split</span> <span class="ruby-string">'.'</span>

  <span class="ruby-identifier">name</span> = <span class="ruby-node">&quot;CN=#{cn}/#{dcs.map { |dc| &quot;DC=#{dc}&quot; }.join '/'}&quot;</span>

  <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">X509</span><span class="ruby-operator">::</span><span class="ruby-constant">Name</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- email_to_name-source -->
            
          </div>

          

          
        </div><!-- email_to_name-method -->
      
        <div id="re_sign-method" class="method-detail ">
          <a name="method-c-re_sign"></a>

          
          <div class="method-heading">
            <span class="method-name">re_sign</span><span
              class="method-args">(expired_certificate, private_key, age = ONE_YEAR, extensions = EXTENSIONS)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Signs <code>expired_certificate</code> with <code>private_key</code> if the
keys match and the expired certificate was self-signed.</p>
            

            
            <div class="method-source-code" id="re_sign-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 484</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">re_sign</span> <span class="ruby-identifier">expired_certificate</span>, <span class="ruby-identifier">private_key</span>, <span class="ruby-identifier">age</span> = <span class="ruby-constant">ONE_YEAR</span>,
                 <span class="ruby-identifier">extensions</span> = <span class="ruby-constant">EXTENSIONS</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span><span class="ruby-operator">::</span><span class="ruby-constant">Exception</span>,
        <span class="ruby-string">&quot;incorrect signing key for re-signing &quot;</span> <span class="ruby-operator">+</span>
        <span class="ruby-node">&quot;#{expired_certificate.subject}&quot;</span> <span class="ruby-keyword">unless</span>
    <span class="ruby-identifier">expired_certificate</span>.<span class="ruby-identifier">public_key</span>.<span class="ruby-identifier">to_pem</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">private_key</span>.<span class="ruby-identifier">public_key</span>.<span class="ruby-identifier">to_pem</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">expired_certificate</span>.<span class="ruby-identifier">subject</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span>
         <span class="ruby-identifier">expired_certificate</span>.<span class="ruby-identifier">issuer</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">subject</span> = <span class="ruby-identifier">alt_name_or_x509_entry</span> <span class="ruby-identifier">expired_certificate</span>, <span class="ruby-value">:subject</span>
    <span class="ruby-identifier">issuer</span>  = <span class="ruby-identifier">alt_name_or_x509_entry</span> <span class="ruby-identifier">expired_certificate</span>, <span class="ruby-value">:issuer</span>

    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span><span class="ruby-operator">::</span><span class="ruby-constant">Exception</span>,
          <span class="ruby-node">&quot;#{subject} is not self-signed, contact #{issuer} &quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-string">&quot;to obtain a valid certificate&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">serial</span> = <span class="ruby-identifier">expired_certificate</span>.<span class="ruby-identifier">serial</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>

  <span class="ruby-identifier">create_cert_self_signed</span>(<span class="ruby-identifier">expired_certificate</span>.<span class="ruby-identifier">subject</span>, <span class="ruby-identifier">private_key</span>, <span class="ruby-identifier">age</span>,
                          <span class="ruby-identifier">extensions</span>, <span class="ruby-identifier">serial</span>)
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- re_sign-source -->
            
          </div>

          

          
        </div><!-- re_sign-method -->
      
        <div id="reset-method" class="method-detail ">
          <a name="method-c-reset"></a>

          
          <div class="method-heading">
            <span class="method-name">reset</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Resets the trust directory for verifying gems.</p>
            

            
            <div class="method-source-code" id="reset-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 510</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">reset</span>
  <span class="ruby-ivar">@trust_dir</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- reset-source -->
            
          </div>

          

          
        </div><!-- reset-method -->
      
        <div id="sign-method" class="method-detail ">
          <a name="method-c-sign"></a>

          
          <div class="method-heading">
            <span class="method-name">sign</span><span
              class="method-args">(certificate, signing_key, signing_cert, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Sign the public key from <code>certificate</code> with the
<code>signing_key</code> and <code>signing_cert</code>, using the
Gem::Security::DIGEST_ALGORITHM.  Uses the default certificate validity
range and extensions.</p>

<p>Returns the newly signed certificate.</p>
            

            
            <div class="method-source-code" id="sign-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 521</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">sign</span> <span class="ruby-identifier">certificate</span>, <span class="ruby-identifier">signing_key</span>, <span class="ruby-identifier">signing_cert</span>,
              <span class="ruby-identifier">age</span> = <span class="ruby-constant">ONE_YEAR</span>, <span class="ruby-identifier">extensions</span> = <span class="ruby-constant">EXTENSIONS</span>, <span class="ruby-identifier">serial</span> = <span class="ruby-value">1</span>
  <span class="ruby-identifier">signee_subject</span> = <span class="ruby-identifier">certificate</span>.<span class="ruby-identifier">subject</span>
  <span class="ruby-identifier">signee_key</span>     = <span class="ruby-identifier">certificate</span>.<span class="ruby-identifier">public_key</span>

  <span class="ruby-identifier">alt_name</span> = <span class="ruby-identifier">certificate</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">find</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">extension</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">extension</span>.<span class="ruby-identifier">oid</span> <span class="ruby-operator">==</span> <span class="ruby-string">'subjectAltName'</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">extensions</span> = <span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">merge</span> <span class="ruby-string">'subjectAltName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">alt_name</span>.<span class="ruby-identifier">value</span> <span class="ruby-keyword">if</span>
    <span class="ruby-identifier">alt_name</span>

  <span class="ruby-identifier">issuer_alt_name</span> = <span class="ruby-identifier">signing_cert</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">find</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">extension</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">extension</span>.<span class="ruby-identifier">oid</span> <span class="ruby-operator">==</span> <span class="ruby-string">'subjectAltName'</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">extensions</span> = <span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">merge</span> <span class="ruby-string">'issuerAltName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">issuer_alt_name</span>.<span class="ruby-identifier">value</span> <span class="ruby-keyword">if</span>
    <span class="ruby-identifier">issuer_alt_name</span>

  <span class="ruby-identifier">signed</span> = <span class="ruby-identifier">create_cert</span> <span class="ruby-identifier">signee_subject</span>, <span class="ruby-identifier">signee_key</span>, <span class="ruby-identifier">age</span>, <span class="ruby-identifier">extensions</span>, <span class="ruby-identifier">serial</span>
  <span class="ruby-identifier">signed</span>.<span class="ruby-identifier">issuer</span> = <span class="ruby-identifier">signing_cert</span>.<span class="ruby-identifier">subject</span>

  <span class="ruby-identifier">signed</span>.<span class="ruby-identifier">sign</span> <span class="ruby-identifier">signing_key</span>, <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span><span class="ruby-operator">::</span><span class="ruby-constant">DIGEST_ALGORITHM</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- sign-source -->
            
          </div>

          

          
        </div><!-- sign-method -->
      
        <div id="trust_dir-method" class="method-detail ">
          <a name="method-c-trust_dir"></a>

          
          <div class="method-heading">
            <span class="method-name">trust_dir</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns a <a href="Security/TrustDir.html">Gem::Security::TrustDir</a>
which wraps the directory where trusted certificates live.</p>
            

            
            <div class="method-source-code" id="trust_dir-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 550</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">trust_dir</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@trust_dir</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@trust_dir</span>

  <span class="ruby-identifier">dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">user_home</span>, <span class="ruby-string">'.gem'</span>, <span class="ruby-string">'trust'</span>

  <span class="ruby-ivar">@trust_dir</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span><span class="ruby-operator">::</span><span class="ruby-constant">TrustDir</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">dir</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- trust_dir-source -->
            
          </div>

          

          
        </div><!-- trust_dir-method -->
      
        <div id="trusted_certificates-method" class="method-detail ">
          <a name="method-c-trusted_certificates"></a>

          
          <div class="method-heading">
            <span class="method-name">trusted_certificates</span><span
              class="method-args">(&block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Enumerates the trusted certificates via <a
href="Security/TrustDir.html">Gem::Security::TrustDir</a>.</p>
            

            
            <div class="method-source-code" id="trusted_certificates-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 561</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">trusted_certificates</span> <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-identifier">trust_dir</span>.<span class="ruby-identifier">each_certificate</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- trusted_certificates-source -->
            
          </div>

          

          
        </div><!-- trusted_certificates-method -->
      
        <div id="write-method" class="method-detail ">
          <a name="method-c-write"></a>

          
          <div class="method-heading">
            <span class="method-name">write</span><span
              class="method-args">(pemmable, path, permissions = 0600, passphrase = nil, cipher = KEY_CIPHER)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Writes <code>pemmable</code>, which must respond to <code>to_pem</code> to
<code>path</code> with the given <code>permissions</code>. If passed
<code>cipher</code> and <code>passphrase</code> those arguments will be
passed to <code>to_pem</code>.</p>
            

            
            <div class="method-source-code" id="write-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File rubygems/security.rb, line 570</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">pemmable</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">permissions</span> = <span class="ruby-value">0600</span>, <span class="ruby-identifier">passphrase</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">cipher</span> = <span class="ruby-constant">KEY_CIPHER</span>
  <span class="ruby-identifier">path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-identifier">path</span>

  <span class="ruby-identifier">open</span> <span class="ruby-identifier">path</span>, <span class="ruby-string">'wb'</span>, <span class="ruby-identifier">permissions</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">passphrase</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">cipher</span>
      <span class="ruby-identifier">io</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">pemmable</span>.<span class="ruby-identifier">to_pem</span> <span class="ruby-identifier">cipher</span>, <span class="ruby-identifier">passphrase</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">io</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">pemmable</span>.<span class="ruby-identifier">to_pem</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">path</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- write-source -->
            
          </div>

          

          
        </div><!-- write-method -->
      
      </div><!-- public-class-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  
  <div id='tx_Security_versioned' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_Security_versioned").load("/associated/2_2_3/Security.html");</script> <div id='tx_Security' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_Security").load("/associated/Security.html");</script> 
      
  <!-- disqus ? -->
   <div class='info'>
  <p>Commenting is here to help enhance the documentation.  For example, code samples, or clarification of the documentation.</p>
  <p>If you have questions about Ruby or the documentation, please post to one of the <a href='http://www.ruby-lang.org/en/community/mailing-lists/'>Ruby mailing lists</a>.  You will get better, faster, help that way.</p>
  <p>If you wish to post a correction of the docs, please do so, but also <a href='http://bugs.ruby-lang.org' >file bug report</a> so that it can be corrected for the next release. Thank you.</p>
  <p>If you want to help improve the Ruby documentation, please visit <a href='http://documenting-ruby.org/'>Documenting-ruby.org</a>.</p> 
    </div>


  
  </div><!-- documentation -->
  <div id='dynamic'>
  </div>
      
        <div id="disqus_thread"></div>
  <script type="text/javascript">
     function setDisqusUrl(){
      var _loc = window.location.href;
      disqus_url = _loc.split("?")[0];
    }

     var disqus_url;
     
    
     setDisqusUrl();
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    // var disqus_shortname = 'rubydocbeta'; // required 
    var disqus_shortname = 'ruby-doc'; // required 


    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

      
<div class='grids wrapper' id="footer">
  <p><small>This page was generated for Ruby 2_2_3</small></p> 
  
   <p><a href="http://ruby-doc.org">Ruby-doc.org</a> is a service of <a href="http://jamesbritt.com">James Britt</a> and <a href="http://neurogami.com">Neurogami</a>, an <a href="http://neurogami.com">application development company in Scottsdale, AZ</a>.</p>
 
    <p><small>Generated with Ruby-doc Rdoc Generator 0.33.0</small>.</p>
  </div>
</div>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-335317-2', 'auto');
  ga('send', 'pageview');

</script>


    
 <script type='text/javascript'>
$(document).ready(function() {
      $.ajaxSetup({ cache: false });
      $("#vulns-alert").load("/associated/vulns.html");
    });

    </script>


 
		<script type='text/javascript'>

	function loadPlus(plusdocs){
//		var img_h = $("img.carbonad-image").css('height');
		//if(img_h != undefined) { //---
			$(plusdocs).find("div[class='associated_wrapper']").each (function() {
					$("#" + this.id).append($(plusdocs).find("#" + this.id ));
					});
		//} // ---
	} // end loadPlusdocs

   function loadInline(json){
    for (var lookFor in json) {
      $(lookFor).after(json[lookFor]);
     }
  } // end loadPlusdocs


$(document).ready(function() {
		$.ajaxSetup({ cache: false });
			$.get('/associated/2_2_3/plus_Security.html', 
			function(plusdocs) {
			setTimeout(function() {
				loadPlus(plusdocs);
				}, 2000);
			}
			);


    $.ajax({
    dataType: "json",
     url: '/associated/2_2_3/inline_Security.js',
     success: function(json) {
			setTimeout(function() {
				loadInline(json);
				}, 2000);
			}
   });

		});
</script>
		
</body>
</html>



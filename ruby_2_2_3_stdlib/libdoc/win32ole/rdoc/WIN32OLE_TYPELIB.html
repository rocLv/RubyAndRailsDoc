<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <!-- classpage -- >
    <!-- RD version: 0.33.0  -->
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  <meta name='description' content='  Class : WIN32OLE_TYPELIB  -   Ruby 2_2_3 ' />
  <meta content="2015-10-03 10:50:16 -0500" http-equiv="change-date" />
  <!-- rel_prefix  = ''  ENV['RDOC_FOR_WEBSITE']   = true-->
    
    
    
  <!-- rel_prefix = '.'   asset_rel_prefix = ''  --> 
  <title>Class: WIN32OLE_TYPELIB (Ruby 2_2_3) </title>
  <!-- link rel="stylesheet" href=".css/obf.css"  -->
  <link rel="stylesheet" href="css/inuit.css" >
  <link rel="stylesheet" href="css/grid.inuit.css" >
  <link rel="stylesheet" href="css/2011.css" type="text/css" >
  <link rel="stylesheet" href="css/rdoc.css" type="text/css" >

  <script src="/js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/rubydoc.js" type="text/javascript" charset="utf-8"></script> 

 
<script src="/js/highlight.min.js"></script>
<script> 
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
  </script> 

  <style type='text/css'>

    #vulns-alert #vulns{
      background-color: #c33 ! important;
      width: 100%;
      text-align: center;
   }
   
   #vulns-alert #vulns a {
    color: #F99 ! important;
   }
 </style>

</head>

<body id="top" class="class rdocstar">
<div id='actionbar' >
<div class='wrapper'>
  <ul class='grids g0'>
	<li class='grid-2' ><a href='/' target='_top' >Home</a></li>
	<li class='grid-2' ><a href='/core' target='_top' >Core </a></li>
	<li class='grid-2' ><a href='/stdlib' target='_top' >Std-lib </a></li>

	 <!-- li class='grid-2' ><a href='/zems' target='_top' >Zems</a></li -->
   <li class='grid-2' ><a href='/downloads' target='_top' >Downloads</a></li>
	 <li class='grid-5 right' id='rd-action-search'><form id="searchbox_011815814100681837392:wnccv6st5qk" action="http://ruby-doc.com/search.html"><input type="hidden" name="cx" value="011815814100681837392:wnccv6st5qk" ><input  id='rd-search-input' name="q" type="text" size="20" >&#160;&#160;<input type="submit" name="sa" value="Search" ><input type="hidden" name="cof" value="FORID:9" ></form></li>
	</ul>
</div>
<span id='vulns-alert'></span>
<!-- VERSION HEADER for 2_2_3 NOT FOUND --></div> <!-- end action bar -->
 <div class='wrapper'>
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
          
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul id='file-metadata'>

          
          
          
          <li class='in-file'>win32ole/win32ole_typelib.c</li>      
            
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-c-typelibs">::typelibs</a></li>
          
          <li><a href="#method-i-guid">#guid</a></li>
          
          <li><a href="#method-i-inspect">#inspect</a></li>
          
          <li><a href="#method-i-library_name">#library_name</a></li>
          
          <li><a href="#method-i-major_version">#major_version</a></li>
          
          <li><a href="#method-i-minor_version">#minor_version</a></li>
          
          <li><a href="#method-i-name">#name</a></li>
          
          <li><a href="#method-i-ole_classes">#ole_classes</a></li>
          
          <li><a href="#method-i-ole_types">#ole_types</a></li>
          
          <li><a href="#method-i-path">#path</a></li>
          
          <li><a href="#method-i-to_s">#to_s</a></li>
          
          <li><a href="#method-i-version">#version</a></li>
          
          <li><a href="#method-i-visible-3F">#visible?</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
          
          
          
          <li><a href="./OLEProperty.html">OLEProperty</a></li>
        
          
          
          <li><a href="./WIN32OLE.html">WIN32OLE</a></li>
        
          
          
          <li><a href="./WIN32OLE/VARIANT.html">WIN32OLE::VARIANT</a></li>
        
          
          
          <li><a href="./WIN32OLERuntimeError.html">WIN32OLERuntimeError</a></li>
        
          
          
          <li><a href="./WIN32OLE_EVENT.html">WIN32OLE_EVENT</a></li>
        
          
          
          <li><a href="./WIN32OLE_METHOD.html">WIN32OLE_METHOD</a></li>
        
          
          
          <li><a href="./WIN32OLE_PARAM.html">WIN32OLE_PARAM</a></li>
        
          
          
          <li><a href="./WIN32OLE_RECORD.html">WIN32OLE_RECORD</a></li>
        
          
          
          <li><a href="./WIN32OLE_TYPE.html">WIN32OLE_TYPE</a></li>
        
          
          
          <li><a href="./WIN32OLE_TYPELIB.html">WIN32OLE_TYPELIB</a></li>
        
          
          
          <li><a href="./WIN32OLE_VARIABLE.html">WIN32OLE_VARIABLE</a></li>
        
          
          
          <li><a href="./WIN32OLE_VARIANT.html">WIN32OLE_VARIANT</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div> <!-- metadata -->
  <div class='adzbox'  id="azk83167">
    
   <div id="carbonads-container"><div class="carbonad"><div id="azcarbon"></div><script type="text/javascript">var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = "http://engine.carbonads.com/z/19647/azcarbon_2_1_0_VERT"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script></div></div>
<script type="text/javascript">
  function checkCarbs() {
    var searchFor = ".car" + "bona" + "d-tag";
    var ctext = $(searchFor);
    if (!ctext.length ) {
     // alert("Cannot find element with class " + searchFor );
      $("#azcarbon").append("<div class='rd-ab-msg'>If you are running an ad blocker please consider white-listing ruby-doc.org. <br><br>Thank you.</div>");
    }
  }
//  window.setTimeout(checkCarbs,3000); 
</script>

   
  </div> 
  <div id="documentation">
    <h1 class="class">WIN32OLE_TYPELIB</h1>

    <div id="description" class="description">
      
<p><code>WIN32OLE_TYPELIB</code> objects represent OLE tyblib information.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">new(typelib [, version1, version2]) &rarr; WIN32OLE_TYPELIB object</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns a new <a href="WIN32OLE_TYPELIB.html">WIN32OLE_TYPELIB</a> object.</p>

<p>The first argument <em>typelib</em>  specifies OLE type library name or
GUID or OLE library file. The second argument is major version or version
of the type library. The third argument is minor version. The second
argument and third argument are optional. If the first argument is type
library name, then the second and third argument are ignored.</p>

<pre class="ruby"><span class="ruby-identifier">tlib1</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">tlib2</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'{00020813-0000-0000-C000-000000000046}'</span>)
<span class="ruby-identifier">tlib3</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'{00020813-0000-0000-C000-000000000046}'</span>, <span class="ruby-value">1.3</span>)
<span class="ruby-identifier">tlib4</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'{00020813-0000-0000-C000-000000000046}'</span>, <span class="ruby-value">1</span>, <span class="ruby-value">3</span>)
<span class="ruby-identifier">tlib5</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;C:\\WINNT\\SYSTEM32\\SHELL32.DLL&quot;</span>)
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib1</span>.<span class="ruby-identifier">name</span>  <span class="ruby-comment"># -&gt; 'Microsoft Excel 9.0 Object Library'</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib2</span>.<span class="ruby-identifier">name</span>  <span class="ruby-comment"># -&gt; 'Microsoft Excel 9.0 Object Library'</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib3</span>.<span class="ruby-identifier">name</span>  <span class="ruby-comment"># -&gt; 'Microsoft Excel 9.0 Object Library'</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib4</span>.<span class="ruby-identifier">name</span>  <span class="ruby-comment"># -&gt; 'Microsoft Excel 9.0 Object Library'</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib5</span>.<span class="ruby-identifier">name</span>  <span class="ruby-comment"># -&gt; 'Microsoft Shell Controls And Automation'</span>
</pre>
            

            
            <div class="method-source-code" id="new-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_initialize(VALUE self, VALUE args)
{
    VALUE found = Qfalse;
    VALUE typelib = Qnil;
    int len = 0;
    OLECHAR * pbuf;
    ITypeLib *pTypeLib;
    HRESULT hr = S_OK;

    len = RARRAY_LEN(args);
    if (len &lt; 1 || len &gt; 3) {
        rb_raise(rb_eArgError, &quot;wrong number of arguments (%d for 1..3)&quot;, len);
    }

    typelib = rb_ary_entry(args, 0);

    SafeStringValue(typelib);

    found = oletypelib_search_registry(self, typelib);
    if (found == Qfalse) {
        found = oletypelib_search_registry2(self, args);
    }
    if (found == Qfalse) {
        pbuf = ole_vstr2wc(typelib);
        hr = LoadTypeLibEx(pbuf, REGKIND_NONE, &amp;pTypeLib);
        SysFreeString(pbuf);
        if (SUCCEEDED(hr)) {
            found = Qtrue;
            oletypelib_set_member(self, pTypeLib);
        }
    }

    if (found == Qfalse) {
        rb_raise(eWIN32OLERuntimeError, &quot;not found type library `%s`&quot;,
                 StringValuePtr(typelib));
    }
    return self;
}
            </pre> 
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->
      
        <div id="typelibs-method" class="method-detail ">
          <a name="method-c-typelibs"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">typelibs</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the array of <a href="WIN32OLE_TYPELIB.html">WIN32OLE_TYPELIB</a>
object.</p>

<pre class="ruby"><span class="ruby-identifier">tlibs</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">typelibs</span>
</pre>
            

            
            <div class="method-source-code" id="typelibs-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_s_typelibs(VALUE self)
{
    HKEY htypelib, hguid;
    DWORD i, j;
    LONG err;
    VALUE guid;
    VALUE version;
    VALUE name = Qnil;
    VALUE typelibs = rb_ary_new();
    VALUE typelib = Qnil;
    HRESULT hr;
    ITypeLib *pTypeLib;

    err = reg_open_key(HKEY_CLASSES_ROOT, &quot;TypeLib&quot;, &amp;htypelib);
    if(err != ERROR_SUCCESS) {
        return typelibs;
    }
    for(i = 0; ; i++) {
        guid = reg_enum_key(htypelib, i);
        if (guid == Qnil)
            break;
        err = reg_open_vkey(htypelib, guid, &amp;hguid);
        if (err != ERROR_SUCCESS)
            continue;
        for(j = 0; ; j++) {
            version = reg_enum_key(hguid, j);
            if (version == Qnil)
                break;
            if ( (name = reg_get_val2(hguid, StringValuePtr(version))) != Qnil ) {
                hr = oletypelib_from_guid(guid, version, &amp;pTypeLib);
                if (SUCCEEDED(hr)) {
                    typelib = create_win32ole_typelib(pTypeLib);
                    rb_ary_push(typelibs, typelib);
                }
            }
        }
        RegCloseKey(hguid);
    }
    RegCloseKey(htypelib);
    return typelibs;
}
            </pre> 
            </div><!-- typelibs-source -->
            
          </div>

          

          
        </div><!-- typelibs-method -->
      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="guid-method" class="method-detail ">
          <a name="method-i-guid"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#guid &rarr; The guid string.</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns guid string which specifies type library.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">guid</span> = <span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">guid</span> <span class="ruby-comment"># -&gt; '{00020813-0000-0000-C000-000000000046}'</span>
</pre>
            

            
            <div class="method-source-code" id="guid-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_guid(VALUE self)
{
    ITypeLib *pTypeLib;
    OLECHAR bstr[80];
    VALUE guid = Qnil;
    int len;
    TLIBATTR *pTLibAttr;

    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    len = StringFromGUID2(&amp;pTLibAttr-&gt;guid, bstr, sizeof(bstr)/sizeof(OLECHAR));
    if (len &gt; 3) {
        guid = ole_wc2vstr(bstr, FALSE);
    }
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return guid;
}
            </pre> 
            </div><!-- guid-source -->
            
          </div>

          

          
        </div><!-- guid-method -->
      
        <div id="inspect-method" class="method-detail ">
          <a name="method-i-inspect"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#inspect &rarr; String</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the type library name with class name.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-comment"># =&gt; &quot;&lt;#WIN32OLE_TYPELIB:Microsoft Excel 9.0 Object Library&gt;&quot;</span>
</pre>
            

            
            <div class="method-source-code" id="inspect-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_inspect(VALUE self)
{
    return default_inspect(self, &quot;WIN32OLE_TYPELIB&quot;);
}
            </pre> 
            </div><!-- inspect-source -->
            
          </div>

          

          
        </div><!-- inspect-method -->
      
        <div id="library_name-method" class="method-detail ">
          <a name="method-i-library_name"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#library_name</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns library name. If the method fails to access library name, <a
href="WIN32OLERuntimeError.html">WIN32OLERuntimeError</a> is raised.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">library_name</span> <span class="ruby-comment"># =&gt; Excel</span>
</pre>
            

            
            <div class="method-source-code" id="library_name-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_library_name(VALUE self)
{
    HRESULT hr;
    ITypeLib *pTypeLib = NULL;
    VALUE libname = Qnil;
    BSTR bstr;

    pTypeLib = itypelib(self);
    hr = pTypeLib-&gt;lpVtbl-&gt;GetDocumentation(pTypeLib, -1,
                                            &amp;bstr, NULL, NULL, NULL);
    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to get library name&quot;);
    }
    libname = WC2VSTR(bstr);
    return libname;
}
            </pre> 
            </div><!-- library_name-source -->
            
          </div>

          

          
        </div><!-- library_name-method -->
      
        <div id="major_version-method" class="method-detail ">
          <a name="method-i-major_version"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#major_version &rarr; The type library major version.</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the type library major version.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">major_version</span> <span class="ruby-comment"># -&gt; 1</span>
</pre>
            

            
            <div class="method-source-code" id="major_version-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_major_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    VALUE major;
    ITypeLib *pTypeLib;
    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);

    major =  INT2NUM(pTLibAttr-&gt;wMajorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return major;
}
            </pre> 
            </div><!-- major_version-source -->
            
          </div>

          

          
        </div><!-- major_version-method -->
      
        <div id="minor_version-method" class="method-detail ">
          <a name="method-i-minor_version"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#minor_version &rarr; The type library minor version.</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the type library minor version.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">minor_version</span> <span class="ruby-comment"># -&gt; 3</span>
</pre>
            

            
            <div class="method-source-code" id="minor_version-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_minor_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    VALUE minor;
    ITypeLib *pTypeLib;
    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    minor =  INT2NUM(pTLibAttr-&gt;wMinorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return minor;
}
            </pre> 
            </div><!-- minor_version-source -->
            
          </div>

          

          
        </div><!-- minor_version-method -->
      
        <div id="name-method" class="method-detail ">
          <a name="method-i-name"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#name &rarr; The type library name</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the type library name.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">name</span> = <span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># -&gt; 'Microsoft Excel 9.0 Object Library'</span>
</pre>
            

            
            <div class="method-source-code" id="name-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_name(VALUE self)
{
    ITypeLib *pTypeLib;
    HRESULT hr;
    BSTR bstr;
    VALUE name;
    pTypeLib = itypelib(self);
    hr = pTypeLib-&gt;lpVtbl-&gt;GetDocumentation(pTypeLib, -1,
                                            NULL, &amp;bstr, NULL, NULL);

    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to get name from ITypeLib&quot;);
    }
    name = WC2VSTR(bstr);
    return name;
}
            </pre> 
            </div><!-- name-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="WIN32OLE_TYPELIB.html#method-i-to_s">to_s</a>
          </div>
          

          
        </div><!-- name-method -->
      
        <div id="ole_classes-method" class="method-detail method-alias">
          <a name="method-i-ole_classes"></a>

          
          <div class="method-heading">
            <span class="method-name">ole_classes</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="WIN32OLE_TYPELIB.html#method-i-ole_types">ole_types</a>
          </div>
          
        </div><!-- ole_classes-method -->
      
        <div id="ole_types-method" class="method-detail ">
          <a name="method-i-ole_types"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#ole_types &rarr; The array of WIN32OLE_TYPE object included the type library.</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the type library file path.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">classes</span> = <span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">ole_types</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">name</span>} <span class="ruby-comment"># -&gt; ['AddIn', 'AddIns' ...]</span>
</pre>
            

            
            <div class="method-source-code" id="ole_types-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_ole_types(VALUE self)
{
    ITypeLib *pTypeLib = NULL;
    VALUE classes = rb_ary_new();
    pTypeLib = itypelib(self);
    ole_types_from_typelib(pTypeLib, classes);
    return classes;
}
            </pre> 
            </div><!-- ole_types-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="WIN32OLE_TYPELIB.html#method-i-ole_classes">ole_classes</a>
          </div>
          

          
        </div><!-- ole_types-method -->
      
        <div id="path-method" class="method-detail ">
          <a name="method-i-path"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#path &rarr; The type library file path.</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the type library file path.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">path</span> <span class="ruby-comment">#-&gt; 'C:\...\EXCEL9.OLB'</span>
</pre>
            

            
            <div class="method-source-code" id="path-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_path(VALUE self)
{
    TLIBATTR *pTLibAttr;
    HRESULT hr = S_OK;
    BSTR bstr;
    LCID lcid = cWIN32OLE_lcid;
    VALUE path;
    ITypeLib *pTypeLib;

    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    hr = QueryPathOfRegTypeLib(&amp;pTLibAttr-&gt;guid,
                               pTLibAttr-&gt;wMajorVerNum,
                               pTLibAttr-&gt;wMinorVerNum,
                               lcid,
                               &amp;bstr);
    if (FAILED(hr)) {
        pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to QueryPathOfRegTypeTypeLib&quot;);
    }

    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    path = WC2VSTR(bstr);
    return path;
}
            </pre> 
            </div><!-- path-source -->
            
          </div>

          

          
        </div><!-- path-method -->
      
        <div id="to_s-method" class="method-detail method-alias">
          <a name="method-i-to_s"></a>

          
          <div class="method-heading">
            <span class="method-name">to_s</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="WIN32OLE_TYPELIB.html#method-i-name">name</a>
          </div>
          
        </div><!-- to_s-method -->
      
        <div id="version-method" class="method-detail ">
          <a name="method-i-version"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#version &rarr; The type library version String object.</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the type library version.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">version</span> <span class="ruby-comment">#-&gt; &quot;1.3&quot;</span>
</pre>
            

            
            <div class="method-source-code" id="version-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    ITypeLib *pTypeLib;
    VALUE version;

    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    version = rb_sprintf(&quot;%d.%d&quot;, pTLibAttr-&gt;wMajorVerNum, pTLibAttr-&gt;wMinorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return version;
}
            </pre> 
            </div><!-- version-source -->
            
          </div>

          

          
        </div><!-- version-method -->
      
        <div id="visible-3F-method" class="method-detail ">
          <a name="method-i-visible-3F"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_TYPELIB#visible?</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns true if the type library information is not hidden. If wLibFlags of
TLIBATTR is 0 or LIBFLAG_FRESTRICTED or LIBFLAG_FHIDDEN, the method returns
false, otherwise, returns true. If the method fails to access the TLIBATTR
information, then <a
href="WIN32OLERuntimeError.html">WIN32OLERuntimeError</a> is raised.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">visible?</span> <span class="ruby-comment"># =&gt; true</span>
</pre>
            

            
            <div class="method-source-code" id="visible-3F-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
foletypelib_visible(VALUE self)
{
    ITypeLib *pTypeLib = NULL;
    VALUE visible = Qtrue;
    TLIBATTR *pTLibAttr;

    pTypeLib = itypelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);

    if ((pTLibAttr-&gt;wLibFlags == 0) ||
        (pTLibAttr-&gt;wLibFlags &amp; LIBFLAG_FRESTRICTED) ||
        (pTLibAttr-&gt;wLibFlags &amp; LIBFLAG_FHIDDEN)) {
        visible = Qfalse;
    }
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return visible;
}
            </pre> 
            </div><!-- visible-3F-source -->
            
          </div>

          

          
        </div><!-- visible-3F-method -->
      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  
  <div id='tx_WIN32OLE_TYPELIB_versioned' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_WIN32OLE_TYPELIB_versioned").load("/associated/2_2_3/WIN32OLE_TYPELIB.html");</script> <div id='tx_WIN32OLE_TYPELIB' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_WIN32OLE_TYPELIB").load("/associated/WIN32OLE_TYPELIB.html");</script> 
      
  <!-- disqus ? -->
   <div class='info'>
  <p>Commenting is here to help enhance the documentation.  For example, code samples, or clarification of the documentation.</p>
  <p>If you have questions about Ruby or the documentation, please post to one of the <a href='http://www.ruby-lang.org/en/community/mailing-lists/'>Ruby mailing lists</a>.  You will get better, faster, help that way.</p>
  <p>If you wish to post a correction of the docs, please do so, but also <a href='http://bugs.ruby-lang.org' >file bug report</a> so that it can be corrected for the next release. Thank you.</p>
  <p>If you want to help improve the Ruby documentation, please visit <a href='http://documenting-ruby.org/'>Documenting-ruby.org</a>.</p> 
    </div>


  
  </div><!-- documentation -->
  <div id='dynamic'>
  </div>
      
        <div id="disqus_thread"></div>
  <script type="text/javascript">
     function setDisqusUrl(){
      var _loc = window.location.href;
      disqus_url = _loc.split("?")[0];
    }

     var disqus_url;
     
    
     setDisqusUrl();
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    // var disqus_shortname = 'rubydocbeta'; // required 
    var disqus_shortname = 'ruby-doc'; // required 


    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

      
<div class='grids wrapper' id="footer">
  <p><small>This page was generated for Ruby 2_2_3</small></p> 
  
   <p><a href="http://ruby-doc.org">Ruby-doc.org</a> is provided by <a href="http://jamesbritt.com">James Britt</a> and <a href="http://neurogami.com">Neurogami</a>. <a href="http://neurogami.com">Maximum R+D</a>.</p>
 
    <p><small>Generated with Ruby-doc Rdoc Generator 0.33.0</small>.</p>
  </div>
</div>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-335317-2', 'auto');
  ga('send', 'pageview');

</script>


    
 <script type='text/javascript'>
$(document).ready(function() {
      $.ajaxSetup({ cache: false });
      $("#vulns-alert").load("/associated/vulns.html");
    });

    </script>


 
		<script type='text/javascript'>

	function loadPlus(plusdocs){
//		var img_h = $("img.carbonad-image").css('height');
		//if(img_h != undefined) { //---
			$(plusdocs).find("div[class='associated_wrapper']").each (function() {
					$("#" + this.id).append($(plusdocs).find("#" + this.id ));
					});
		//} // ---
	} // end loadPlusdocs

   function loadInline(json){
    for (var lookFor in json) {
      $(lookFor).after(json[lookFor]);
     }
  } // end loadPlusdocs


$(document).ready(function() {
		$.ajaxSetup({ cache: false });
			$.get('/associated/2_2_3/plus_WIN32OLE_TYPELIB.html', 
			function(plusdocs) {
			setTimeout(function() {
				loadPlus(plusdocs);
				}, 2000);
			}
			);


    $.ajax({
    dataType: "json",
     url: '/associated/2_2_3/inline_WIN32OLE_TYPELIB.js',
     success: function(json) {
			setTimeout(function() {
				loadInline(json);
				}, 2000);
			}
   });

		});
</script>
		
</body>
</html>


